{"ast":null,"code":"/**\n * @license\n * Copyright 2019 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\nimport { util, tidy, deprecationWarn, Tensor, stack, ENV, clone, dispose } from \"@tensorflow/tfjs-core\";\n\nvar _extendStatics = function extendStatics(t, e) {\n  return (_extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (t, e) {\n    t.__proto__ = e;\n  } || function (t, e) {\n    for (var r in e) {\n      e.hasOwnProperty(r) && (t[r] = e[r]);\n    }\n  })(t, e);\n};\n\nfunction __extends(t, e) {\n  function r() {\n    this.constructor = t;\n  }\n\n  _extendStatics(t, e), t.prototype = null === e ? Object.create(e) : (r.prototype = e.prototype, new r());\n}\n\nfunction __awaiter(t, e, r, n) {\n  return new (r || (r = Promise))(function (o, i) {\n    function s(t) {\n      try {\n        u(n.next(t));\n      } catch (t) {\n        i(t);\n      }\n    }\n\n    function a(t) {\n      try {\n        u(n.throw(t));\n      } catch (t) {\n        i(t);\n      }\n    }\n\n    function u(t) {\n      t.done ? o(t.value) : new r(function (e) {\n        e(t.value);\n      }).then(s, a);\n    }\n\n    u((n = n.apply(t, e || [])).next());\n  });\n}\n\nfunction __generator(t, e) {\n  var r,\n      n,\n      o,\n      i,\n      s = {\n    label: 0,\n    sent: function sent() {\n      if (1 & o[0]) throw o[1];\n      return o[1];\n    },\n    trys: [],\n    ops: []\n  };\n  return i = {\n    next: a(0),\n    throw: a(1),\n    return: a(2)\n  }, \"function\" == typeof Symbol && (i[Symbol.iterator] = function () {\n    return this;\n  }), i;\n\n  function a(i) {\n    return function (a) {\n      return function (i) {\n        if (r) throw new TypeError(\"Generator is already executing.\");\n\n        for (; s;) {\n          try {\n            if (r = 1, n && (o = 2 & i[0] ? n.return : i[0] ? n.throw || ((o = n.return) && o.call(n), 0) : n.next) && !(o = o.call(n, i[1])).done) return o;\n\n            switch (n = 0, o && (i = [2 & i[0], o.value]), i[0]) {\n              case 0:\n              case 1:\n                o = i;\n                break;\n\n              case 4:\n                return s.label++, {\n                  value: i[1],\n                  done: !1\n                };\n\n              case 5:\n                s.label++, n = i[1], i = [0];\n                continue;\n\n              case 7:\n                i = s.ops.pop(), s.trys.pop();\n                continue;\n\n              default:\n                if (!(o = (o = s.trys).length > 0 && o[o.length - 1]) && (6 === i[0] || 2 === i[0])) {\n                  s = 0;\n                  continue;\n                }\n\n                if (3 === i[0] && (!o || i[1] > o[0] && i[1] < o[3])) {\n                  s.label = i[1];\n                  break;\n                }\n\n                if (6 === i[0] && s.label < o[1]) {\n                  s.label = o[1], o = i;\n                  break;\n                }\n\n                if (o && s.label < o[2]) {\n                  s.label = o[2], s.ops.push(i);\n                  break;\n                }\n\n                o[2] && s.ops.pop(), s.trys.pop();\n                continue;\n            }\n\n            i = e.call(t, s);\n          } catch (t) {\n            i = [6, t], n = 0;\n          } finally {\n            r = o = 0;\n          }\n        }\n\n        if (5 & i[0]) throw i[1];\n        return {\n          value: i[0] ? i[1] : void 0,\n          done: !0\n        };\n      }([i, a]);\n    };\n  }\n}\n\nvar commonjsGlobal = \"undefined\" != typeof window ? window : \"undefined\" != typeof global ? global : \"undefined\" != typeof self ? self : {};\n\nfunction unwrapExports(t) {\n  return t && t.__esModule && Object.prototype.hasOwnProperty.call(t, \"default\") ? t.default : t;\n}\n\nfunction createCommonjsModule(t, e) {\n  return t(e = {\n    exports: {}\n  }, e.exports), e.exports;\n}\n\nvar alea = createCommonjsModule(function (t) {\n  !function (t, e, r) {\n    function n(t, e) {\n      return e.c = t.c, e.s0 = t.s0, e.s1 = t.s1, e.s2 = t.s2, e;\n    }\n\n    function o(t, e) {\n      var r = new function (t) {\n        var e,\n            r = this,\n            n = (e = 4022871197, function (t) {\n          t = t.toString();\n\n          for (var r = 0; r < t.length; r++) {\n            var n = .02519603282416938 * (e += t.charCodeAt(r));\n            n -= e = n >>> 0, e = (n *= e) >>> 0, e += 4294967296 * (n -= e);\n          }\n\n          return 2.3283064365386963e-10 * (e >>> 0);\n        });\n        r.next = function () {\n          var t = 2091639 * r.s0 + 2.3283064365386963e-10 * r.c;\n          return r.s0 = r.s1, r.s1 = r.s2, r.s2 = t - (r.c = 0 | t);\n        }, r.c = 1, r.s0 = n(\" \"), r.s1 = n(\" \"), r.s2 = n(\" \"), r.s0 -= n(t), r.s0 < 0 && (r.s0 += 1), r.s1 -= n(t), r.s1 < 0 && (r.s1 += 1), r.s2 -= n(t), r.s2 < 0 && (r.s2 += 1), n = null;\n      }(t),\n          o = e && e.state,\n          i = r.next;\n      return i.int32 = function () {\n        return 4294967296 * r.next() | 0;\n      }, i.double = function () {\n        return i() + 1.1102230246251565e-16 * (2097152 * i() | 0);\n      }, i.quick = i, o && (\"object\" == typeof o && n(o, r), i.state = function () {\n        return n(r, {});\n      }), i;\n    }\n\n    e && e.exports ? e.exports = o : r && r.amd ? r(function () {\n      return o;\n    }) : this.alea = o;\n  }(0, t, !1);\n}),\n    xor128 = createCommonjsModule(function (t) {\n  !function (t, e, r) {\n    function n(t, e) {\n      return e.x = t.x, e.y = t.y, e.z = t.z, e.w = t.w, e;\n    }\n\n    function o(t, e) {\n      var r = new function (t) {\n        var e = this,\n            r = \"\";\n        e.x = 0, e.y = 0, e.z = 0, e.w = 0, e.next = function () {\n          var t = e.x ^ e.x << 11;\n          return e.x = e.y, e.y = e.z, e.z = e.w, e.w ^= e.w >>> 19 ^ t ^ t >>> 8;\n        }, t === (0 | t) ? e.x = t : r += t;\n\n        for (var n = 0; n < r.length + 64; n++) {\n          e.x ^= 0 | r.charCodeAt(n), e.next();\n        }\n      }(t),\n          o = e && e.state,\n          i = function i() {\n        return (r.next() >>> 0) / 4294967296;\n      };\n\n      return i.double = function () {\n        do {\n          var t = ((r.next() >>> 11) + (r.next() >>> 0) / 4294967296) / (1 << 21);\n        } while (0 === t);\n\n        return t;\n      }, i.int32 = r.next, i.quick = i, o && (\"object\" == typeof o && n(o, r), i.state = function () {\n        return n(r, {});\n      }), i;\n    }\n\n    e && e.exports ? e.exports = o : r && r.amd ? r(function () {\n      return o;\n    }) : this.xor128 = o;\n  }(0, t, !1);\n}),\n    xorwow = createCommonjsModule(function (t) {\n  !function (t, e, r) {\n    function n(t, e) {\n      return e.x = t.x, e.y = t.y, e.z = t.z, e.w = t.w, e.v = t.v, e.d = t.d, e;\n    }\n\n    function o(t, e) {\n      var r = new function (t) {\n        var e = this,\n            r = \"\";\n        e.next = function () {\n          var t = e.x ^ e.x >>> 2;\n          return e.x = e.y, e.y = e.z, e.z = e.w, e.w = e.v, (e.d = e.d + 362437 | 0) + (e.v = e.v ^ e.v << 4 ^ t ^ t << 1) | 0;\n        }, e.x = 0, e.y = 0, e.z = 0, e.w = 0, e.v = 0, t === (0 | t) ? e.x = t : r += t;\n\n        for (var n = 0; n < r.length + 64; n++) {\n          e.x ^= 0 | r.charCodeAt(n), n == r.length && (e.d = e.x << 10 ^ e.x >>> 4), e.next();\n        }\n      }(t),\n          o = e && e.state,\n          i = function i() {\n        return (r.next() >>> 0) / 4294967296;\n      };\n\n      return i.double = function () {\n        do {\n          var t = ((r.next() >>> 11) + (r.next() >>> 0) / 4294967296) / (1 << 21);\n        } while (0 === t);\n\n        return t;\n      }, i.int32 = r.next, i.quick = i, o && (\"object\" == typeof o && n(o, r), i.state = function () {\n        return n(r, {});\n      }), i;\n    }\n\n    e && e.exports ? e.exports = o : r && r.amd ? r(function () {\n      return o;\n    }) : this.xorwow = o;\n  }(0, t, !1);\n}),\n    xorshift7 = createCommonjsModule(function (t) {\n  !function (t, e, r) {\n    function n(t, e) {\n      return e.x = t.x.slice(), e.i = t.i, e;\n    }\n\n    function o(t, e) {\n      null == t && (t = +new Date());\n\n      var r = new function (t) {\n        var e = this;\n        e.next = function () {\n          var t,\n              r,\n              n = e.x,\n              o = e.i;\n          return t = n[o], r = (t ^= t >>> 7) ^ t << 24, r ^= (t = n[o + 1 & 7]) ^ t >>> 10, r ^= (t = n[o + 3 & 7]) ^ t >>> 3, r ^= (t = n[o + 4 & 7]) ^ t << 7, t = n[o + 7 & 7], r ^= (t ^= t << 13) ^ t << 9, n[o] = r, e.i = o + 1 & 7, r;\n        }, function (t, e) {\n          var r,\n              n = [];\n          if (e === (0 | e)) n[0] = e;else for (e = \"\" + e, r = 0; r < e.length; ++r) {\n            n[7 & r] = n[7 & r] << 15 ^ e.charCodeAt(r) + n[r + 1 & 7] << 13;\n          }\n\n          for (; n.length < 8;) {\n            n.push(0);\n          }\n\n          for (r = 0; r < 8 && 0 === n[r]; ++r) {\n            ;\n          }\n\n          for (8 == r ? n[7] = -1 : n[r], t.x = n, t.i = 0, r = 256; r > 0; --r) {\n            t.next();\n          }\n        }(e, t);\n      }(t),\n          o = e && e.state,\n          i = function i() {\n        return (r.next() >>> 0) / 4294967296;\n      };\n\n      return i.double = function () {\n        do {\n          var t = ((r.next() >>> 11) + (r.next() >>> 0) / 4294967296) / (1 << 21);\n        } while (0 === t);\n\n        return t;\n      }, i.int32 = r.next, i.quick = i, o && (o.x && n(o, r), i.state = function () {\n        return n(r, {});\n      }), i;\n    }\n\n    e && e.exports ? e.exports = o : r && r.amd ? r(function () {\n      return o;\n    }) : this.xorshift7 = o;\n  }(0, t, !1);\n}),\n    xor4096 = createCommonjsModule(function (t) {\n  !function (t, e, r) {\n    function n(t, e) {\n      return e.i = t.i, e.w = t.w, e.X = t.X.slice(), e;\n    }\n\n    function o(t, e) {\n      null == t && (t = +new Date());\n\n      var r = new function (t) {\n        var e = this;\n        e.next = function () {\n          var t,\n              r,\n              n = e.w,\n              o = e.X,\n              i = e.i;\n          return e.w = n = n + 1640531527 | 0, r = o[i + 34 & 127], t = o[i = i + 1 & 127], r ^= r << 13, t ^= t << 17, r ^= r >>> 15, t ^= t >>> 12, r = o[i] = r ^ t, e.i = i, r + (n ^ n >>> 16) | 0;\n        }, function (t, e) {\n          var r,\n              n,\n              o,\n              i,\n              s,\n              a = [],\n              u = 128;\n\n          for (e === (0 | e) ? (n = e, e = null) : (e += \"\\0\", n = 0, u = Math.max(u, e.length)), o = 0, i = -32; i < u; ++i) {\n            e && (n ^= e.charCodeAt((i + 32) % e.length)), 0 === i && (s = n), n ^= n << 10, n ^= n >>> 15, n ^= n << 4, n ^= n >>> 13, i >= 0 && (s = s + 1640531527 | 0, o = 0 == (r = a[127 & i] ^= n + s) ? o + 1 : 0);\n          }\n\n          for (o >= 128 && (a[127 & (e && e.length || 0)] = -1), o = 127, i = 512; i > 0; --i) {\n            n = a[o + 34 & 127], r = a[o = o + 1 & 127], n ^= n << 13, r ^= r << 17, n ^= n >>> 15, r ^= r >>> 12, a[o] = n ^ r;\n          }\n\n          t.w = s, t.X = a, t.i = o;\n        }(e, t);\n      }(t),\n          o = e && e.state,\n          i = function i() {\n        return (r.next() >>> 0) / 4294967296;\n      };\n\n      return i.double = function () {\n        do {\n          var t = ((r.next() >>> 11) + (r.next() >>> 0) / 4294967296) / (1 << 21);\n        } while (0 === t);\n\n        return t;\n      }, i.int32 = r.next, i.quick = i, o && (o.X && n(o, r), i.state = function () {\n        return n(r, {});\n      }), i;\n    }\n\n    e && e.exports ? e.exports = o : r && r.amd ? r(function () {\n      return o;\n    }) : this.xor4096 = o;\n  }(0, t, !1);\n}),\n    tychei = createCommonjsModule(function (t) {\n  !function (t, e, r) {\n    function n(t, e) {\n      return e.a = t.a, e.b = t.b, e.c = t.c, e.d = t.d, e;\n    }\n\n    function o(t, e) {\n      var r = new function (t) {\n        var e = this,\n            r = \"\";\n        e.next = function () {\n          var t = e.b,\n              r = e.c,\n              n = e.d,\n              o = e.a;\n          return t = t << 25 ^ t >>> 7 ^ r, r = r - n | 0, n = n << 24 ^ n >>> 8 ^ o, o = o - t | 0, e.b = t = t << 20 ^ t >>> 12 ^ r, e.c = r = r - n | 0, e.d = n << 16 ^ r >>> 16 ^ o, e.a = o - t | 0;\n        }, e.a = 0, e.b = 0, e.c = -1640531527, e.d = 1367130551, t === Math.floor(t) ? (e.a = t / 4294967296 | 0, e.b = 0 | t) : r += t;\n\n        for (var n = 0; n < r.length + 20; n++) {\n          e.b ^= 0 | r.charCodeAt(n), e.next();\n        }\n      }(t),\n          o = e && e.state,\n          i = function i() {\n        return (r.next() >>> 0) / 4294967296;\n      };\n\n      return i.double = function () {\n        do {\n          var t = ((r.next() >>> 11) + (r.next() >>> 0) / 4294967296) / (1 << 21);\n        } while (0 === t);\n\n        return t;\n      }, i.int32 = r.next, i.quick = i, o && (\"object\" == typeof o && n(o, r), i.state = function () {\n        return n(r, {});\n      }), i;\n    }\n\n    e && e.exports ? e.exports = o : r && r.amd ? r(function () {\n      return o;\n    }) : this.tychei = o;\n  }(0, t, !1);\n}),\n    seedrandom = createCommonjsModule(function (t) {\n  !function (e, r) {\n    var n,\n        o = (0, eval)(\"this\"),\n        i = 256,\n        s = 6,\n        a = \"random\",\n        u = r.pow(i, s),\n        h = r.pow(2, 52),\n        c = 2 * h,\n        l = i - 1;\n\n    function f(t, f, m) {\n      var v = [],\n          w = d(function t(e, r) {\n        var n,\n            o = [],\n            i = typeof e;\n        if (r && \"object\" == i) for (n in e) {\n          try {\n            o.push(t(e[n], r - 1));\n          } catch (t) {}\n        }\n        return o.length ? o : \"string\" == i ? e : e + \"\\0\";\n      }((f = 1 == f ? {\n        entropy: !0\n      } : f || {}).entropy ? [t, y(e)] : null == t ? function () {\n        try {\n          var t;\n          return n && (t = n.randomBytes) ? t = t(i) : (t = new Uint8Array(i), (o.crypto || o.msCrypto).getRandomValues(t)), y(t);\n        } catch (t) {\n          var r = o.navigator,\n              s = r && r.plugins;\n          return [+new Date(), o, s, o.screen, y(e)];\n        }\n      }() : t, 3), v),\n          _ = new function (t) {\n        var e,\n            r = t.length,\n            n = this,\n            o = 0,\n            s = n.i = n.j = 0,\n            a = n.S = [];\n        r || (t = [r++]);\n\n        for (; o < i;) {\n          a[o] = o++;\n        }\n\n        for (o = 0; o < i; o++) {\n          a[o] = a[s = l & s + t[o % r] + (e = a[o])], a[s] = e;\n        }\n\n        (n.g = function (t) {\n          for (var e, r = 0, o = n.i, s = n.j, a = n.S; t--;) {\n            e = a[o = l & o + 1], r = r * i + a[l & (a[o] = a[s = l & s + e]) + (a[s] = e)];\n          }\n\n          return n.i = o, n.j = s, r;\n        })(i);\n      }(v),\n          g = function g() {\n        for (var t = _.g(s), e = u, r = 0; t < h;) {\n          t = (t + r) * i, e *= i, r = _.g(1);\n        }\n\n        for (; t >= c;) {\n          t /= 2, e /= 2, r >>>= 1;\n        }\n\n        return (t + r) / e;\n      };\n\n      return g.int32 = function () {\n        return 0 | _.g(4);\n      }, g.quick = function () {\n        return _.g(4) / 4294967296;\n      }, g.double = g, d(y(_.S), e), (f.pass || m || function (t, e, n, o) {\n        return o && (o.S && p(o, _), t.state = function () {\n          return p(_, {});\n        }), n ? (r[a] = t, e) : t;\n      })(g, w, \"global\" in f ? f.global : this == r, f.state);\n    }\n\n    function p(t, e) {\n      return e.i = t.i, e.j = t.j, e.S = t.S.slice(), e;\n    }\n\n    function d(t, e) {\n      for (var r, n = t + \"\", o = 0; o < n.length;) {\n        e[l & o] = l & (r ^= 19 * e[l & o]) + n.charCodeAt(o++);\n      }\n\n      return y(e);\n    }\n\n    function y(t) {\n      return String.fromCharCode.apply(0, t);\n    }\n\n    if (r[\"seed\" + a] = f, d(r.random(), e), t.exports) {\n      t.exports = f;\n\n      try {\n        n = require(\"crypto\");\n      } catch (t) {}\n    } else 0;\n  }([], Math);\n});\nseedrandom.alea = alea, seedrandom.xor128 = xor128, seedrandom.xorwow = xorwow, seedrandom.xorshift7 = xorshift7, seedrandom.xor4096 = xor4096, seedrandom.tychei = tychei;\nvar seedrandom$1 = seedrandom,\n    seedrandom_1 = seedrandom$1.alea,\n    util$1 = createCommonjsModule(function (t, e) {\n  function r(t) {\n    for (var e = t.length, r = 0, n = 0; e > 0;) {\n      n = Math.random() * e | 0, r = t[--e], t[e] = t[n], t[n] = r;\n    }\n  }\n\n  function n(t, e) {\n    if (!t) throw new Error(\"string\" == typeof e ? e : e());\n  }\n\n  function o(t, e) {\n    if (void 0 === e && (e = []), Array.isArray(t) || h(t)) for (var r = 0; r < t.length; ++r) {\n      o(t[r], e);\n    } else e.push(t);\n    return e;\n  }\n\n  function i(t, e) {\n    if (t === e) return !0;\n    if (null == t || null == e) return !1;\n    if (t.length !== e.length) return !1;\n\n    for (var r = 0; r < t.length; r++) {\n      if (t[r] !== e[r]) return !1;\n    }\n\n    return !0;\n  }\n\n  function s(t) {\n    return t % 1 == 0;\n  }\n\n  function a(t, e) {\n    var r = e.length;\n    return n((t = null == t ? e.map(function (t, e) {\n      return e;\n    }) : [].concat(t)).every(function (t) {\n      return t >= -r && t < r;\n    }), \"All values in axis param must be in range [-\" + r + \", \" + r + \") but got axis \" + t), n(t.every(function (t) {\n      return s(t);\n    }), \"All values in axis param must be integers but got axis \" + t), t.map(function (t) {\n      return t < 0 ? r + t : t;\n    });\n  }\n\n  function u(t, e) {\n    for (var r = 0; r < t.length; r++) {\n      var n = t[r];\n      if (isNaN(n) || !isFinite(n)) throw Error(\"A tensor of type \" + e + \" being uploaded contains \" + n + \".\");\n    }\n  }\n\n  function h(t) {\n    return t instanceof Float32Array || t instanceof Int32Array || t instanceof Uint8Array;\n  }\n\n  function c(t) {\n    return \"string\" == typeof t || t instanceof String;\n  }\n\n  function l(t) {\n    return \"boolean\" == typeof t;\n  }\n\n  function f(t) {\n    return \"number\" == typeof t;\n  }\n\n  function p(t, e) {\n    if (null == e || \"float32\" === e || \"complex64\" === e) return new Float32Array(t);\n    if (\"int32\" === e) return new Int32Array(t);\n    if (\"bool\" === e) return new Uint8Array(t);\n    throw new Error(\"Unknown data type \" + e);\n  }\n\n  Object.defineProperty(e, \"__esModule\", {\n    value: !0\n  }), e.shuffle = r, e.clamp = function (t, e, r) {\n    return Math.max(t, Math.min(e, r));\n  }, e.nearestLargerEven = function (t) {\n    return t % 2 == 0 ? t : t + 1;\n  }, e.sum = function (t) {\n    for (var e = 0, r = 0; r < t.length; r++) {\n      e += t[r];\n    }\n\n    return e;\n  }, e.randUniform = function (t, e) {\n    var r = Math.random();\n    return e * r + (1 - r) * t;\n  }, e.distSquared = function (t, e) {\n    for (var r = 0, n = 0; n < t.length; n++) {\n      var o = Number(t[n]) - Number(e[n]);\n      r += o * o;\n    }\n\n    return r;\n  }, e.assert = n, e.assertShapesMatch = function (t, e, r) {\n    void 0 === r && (r = \"\"), n(i(t, e), r + \" Shapes \" + t + \" and \" + e + \" must match\");\n  }, e.assertNonNull = function (t) {\n    n(null != t, \"The input to the tensor constructor must be a non-null value.\");\n  }, e.flatten = o, e.sizeFromShape = function (t) {\n    if (0 === t.length) return 1;\n\n    for (var e = t[0], r = 1; r < t.length; r++) {\n      e *= t[r];\n    }\n\n    return e;\n  }, e.isScalarShape = function (t) {\n    return 0 === t.length;\n  }, e.arraysEqual = i, e.isInt = s, e.tanh = function (t) {\n    if (null != Math.tanh) return Math.tanh(t);\n    if (t === 1 / 0) return 1;\n    if (t === -1 / 0) return -1;\n    var e = Math.exp(2 * t);\n    return (e - 1) / (e + 1);\n  }, e.sizeToSquarishShape = function (t) {\n    var e = Math.ceil(Math.sqrt(t));\n    return [e, Math.ceil(t / e)];\n  }, e.createShuffledIndices = function (t) {\n    for (var e = new Uint32Array(t), n = 0; n < t; ++n) {\n      e[n] = n;\n    }\n\n    return r(e), e;\n  }, e.rightPad = function (t, e) {\n    return e <= t.length ? t : t + \" \".repeat(e - t.length);\n  }, e.repeatedTry = function (t, e, r) {\n    return void 0 === e && (e = function e(t) {\n      return 0;\n    }), new Promise(function (n, o) {\n      var i = 0,\n          s = function s() {\n        if (t()) n();else {\n          var a = e(++i);\n          null != r && i >= r ? o() : setTimeout(s, a);\n        }\n      };\n\n      s();\n    });\n  }, e.inferFromImplicitShape = function (t, e) {\n    for (var r = 1, n = -1, o = 0; o < t.length; ++o) {\n      if (t[o] >= 0) r *= t[o];else if (-1 === t[o]) {\n        if (-1 !== n) throw Error(\"Shapes can only have 1 implicit size. Found -1 at dim \" + n + \" and dim \" + o);\n        n = o;\n      } else if (t[o] < 0) throw Error(\"Shapes can not be < 0. Found \" + t[o] + \" at dim \" + o);\n    }\n\n    if (-1 === n) {\n      if (e > 0 && e !== r) throw Error(\"Size(\" + e + \") must match the product of shape \" + t);\n      return t;\n    }\n\n    if (0 === r) throw Error(\"Cannot infer the missing size in [\" + t + \"] when there are 0 elements\");\n    if (e % r != 0) throw Error(\"The implicit shape can't be a fractional number. Got \" + e + \" / \" + r);\n    var i = t.slice();\n    return i[n] = e / r, i;\n  }, e.parseAxisParam = a, e.squeezeShape = function (t, e) {\n    for (var r = [], n = [], o = null == e ? null : a(e, t).sort(), i = 0, s = 0; s < t.length; ++s) {\n      if (null != o) {\n        if (o[i] === s && 1 !== t[s]) throw new Error(\"Can't squeeze axis \" + s + \" since its dim '\" + t[s] + \"' is not 1\");\n        (null == o[i] || o[i] > s) && 1 === t[s] && (r.push(t[s]), n.push(s)), o[i] <= s && i++;\n      }\n\n      1 !== t[s] && (r.push(t[s]), n.push(s));\n    }\n\n    return {\n      newShape: r,\n      keptDims: n\n    };\n  }, e.getTypedArrayFromDType = function (t, e) {\n    var r = null;\n    if (null == t || \"float32\" === t) r = new Float32Array(e);else if (\"int32\" === t) r = new Int32Array(e);else {\n      if (\"bool\" !== t) throw new Error(\"Unknown data type \" + t);\n      r = new Uint8Array(e);\n    }\n    return r;\n  }, e.getArrayFromDType = function (t, e) {\n    var r = null;\n    if (null == t || \"float32\" === t) r = new Float32Array(e);else if (\"int32\" === t) r = new Int32Array(e);else if (\"bool\" === t) r = new Uint8Array(e);else {\n      if (\"string\" !== t) throw new Error(\"Unknown data type \" + t);\n      r = new Array(e);\n    }\n    return r;\n  }, e.checkComputationForErrors = function (t, e, r) {\n    if (\"float32\" === e) for (var n = 0; n < t.length; n++) {\n      var o = t[n];\n      if (isNaN(o) || !isFinite(o)) throw Error(\"The result of the '\" + r + \"' is \" + o + \".\");\n    }\n  }, e.checkConversionForErrors = u, e.hasEncodingLoss = function (t, e) {\n    return !(\"complex64\" === e || \"float32\" === e && \"complex64\" !== t || \"int32\" === e && \"float32\" !== t && \"complex64\" !== t || \"bool\" === e && \"bool\" === t);\n  }, e.isTypedArray = h, e.bytesPerElement = function (t) {\n    if (\"float32\" === t || \"int32\" === t) return 4;\n    if (\"complex64\" === t) return 8;\n    if (\"bool\" === t) return 1;\n    throw new Error(\"Unknown dtype \" + t);\n  }, e.bytesFromStringArray = function (t) {\n    if (null == t) return 0;\n    var e = 0;\n    return t.forEach(function (t) {\n      return e += 2 * t.length;\n    }), e;\n  }, e.isString = c, e.isBoolean = l, e.isNumber = f, e.inferDtype = function t(e) {\n    return Array.isArray(e) ? t(e[0]) : e instanceof Float32Array ? \"float32\" : e instanceof Int32Array || e instanceof Uint8Array ? \"int32\" : f(e) ? \"float32\" : c(e) ? \"string\" : l(e) ? \"bool\" : \"float32\";\n  }, e.isFunction = function (t) {\n    return !!(t && t.constructor && t.call && t.apply);\n  }, e.nearestDivisor = function (t, e) {\n    for (var r = e; r < t; ++r) {\n      if (t % r == 0) return r;\n    }\n\n    return t;\n  }, e.computeStrides = function (t) {\n    var e = t.length;\n    if (e < 2) return [];\n    var r = new Array(e - 1);\n    r[e - 2] = t[e - 1];\n\n    for (var n = e - 3; n >= 0; --n) {\n      r[n] = r[n + 1] * t[n + 1];\n    }\n\n    return r;\n  }, e.toTypedArray = function (t, e, r) {\n    if (\"string\" === e) throw new Error(\"Cannot convert a string[] to a TypedArray\");\n    if (Array.isArray(t) && (t = o(t)), r && u(t, e), function (t, e) {\n      return t instanceof Float32Array && \"float32\" === e || t instanceof Int32Array && \"int32\" === e || t instanceof Uint8Array && \"bool\" === e;\n    }(t, e)) return t;\n    if (null == e || \"float32\" === e || \"complex64\" === e) return new Float32Array(t);\n    if (\"int32\" === e) return new Int32Array(t);\n\n    if (\"bool\" === e) {\n      for (var n = new Uint8Array(t.length), i = 0; i < n.length; ++i) {\n        0 !== Math.round(t[i]) && (n[i] = 1);\n      }\n\n      return n;\n    }\n\n    throw new Error(\"Unknown data type \" + e);\n  }, e.toNestedArray = function (t, e) {\n    if (0 === t.length) return e[0];\n    var r = t.reduce(function (t, e) {\n      return t * e;\n    });\n    if (0 === r) return [];\n    if (r !== e.length) throw new Error(\"[\" + t + \"] does not match the input size.\");\n    return function t(e, r, n) {\n      var o = new Array();\n      if (1 === r.length) for (var i = r[0], s = 0; s < i; s++) {\n        o[s] = n[e + s];\n      } else {\n        i = r[0];\n        var a = r.slice(1),\n            u = a.reduce(function (t, e) {\n          return t * e;\n        });\n\n        for (s = 0; s < i; s++) {\n          o[s] = t(e + s * u, a, n);\n        }\n      }\n      return o;\n    }(0, t, e);\n  }, e.makeOnesTypedArray = function (t, e) {\n    for (var r = p(t, e), n = 0; n < r.length; n++) {\n      r[n] = 1;\n    }\n\n    return r;\n  }, e.makeZerosTypedArray = p, e.now = function () {\n    if (\"undefined\" != typeof performance) return performance.now();\n\n    if (\"undefined\" != typeof process) {\n      var t = process.hrtime();\n      return 1e3 * t[0] + t[1] / 1e6;\n    }\n\n    throw new Error(\"Cannot measure time in this environment. You should run tf.js in the browser or in Node.js\");\n  }, e.monitorPromisesProgress = function (t, e, r, o) {\n    !function (t) {\n      n(null != t && Array.isArray(t) && t.length > 0, \"promises must be a none empty array\");\n    }(t), function (t, e) {\n      n(t >= 0 && t <= 1, \"Progress fraction must be in range [0, 1], but got startFraction \" + t), n(e >= 0 && e <= 1, \"Progress fraction must be in range [0, 1], but got endFraction \" + e), n(e >= t, \"startFraction must be no more than endFraction, but got startFraction \" + t + \" and endFraction \" + e);\n    }(r = null == r ? 0 : r, o = null == o ? 1 : o);\n    var i = 0;\n    return Promise.all(t.map(function (n) {\n      return n.then(function (n) {\n        var s = r + ++i / t.length * (o - r);\n        return e(s), n;\n      }), n;\n    }));\n  };\n});\nunwrapExports(util$1);\nvar util_1 = util$1.shuffle,\n    util_2 = util$1.clamp,\n    util_3 = util$1.nearestLargerEven,\n    util_4 = util$1.sum,\n    util_5 = util$1.randUniform,\n    util_6 = util$1.distSquared,\n    util_7 = util$1.assert,\n    util_8 = util$1.assertShapesMatch,\n    util_9 = util$1.assertNonNull,\n    util_10 = util$1.flatten,\n    util_11 = util$1.sizeFromShape,\n    util_12 = util$1.isScalarShape,\n    util_13 = util$1.arraysEqual,\n    util_14 = util$1.isInt,\n    util_15 = util$1.tanh,\n    util_16 = util$1.sizeToSquarishShape,\n    util_17 = util$1.createShuffledIndices,\n    util_18 = util$1.rightPad,\n    util_19 = util$1.repeatedTry,\n    util_20 = util$1.inferFromImplicitShape,\n    util_21 = util$1.parseAxisParam,\n    util_22 = util$1.squeezeShape,\n    util_23 = util$1.getTypedArrayFromDType,\n    util_24 = util$1.getArrayFromDType,\n    util_25 = util$1.checkComputationForErrors,\n    util_26 = util$1.checkConversionForErrors,\n    util_27 = util$1.hasEncodingLoss,\n    util_28 = util$1.isTypedArray,\n    util_29 = util$1.bytesPerElement,\n    util_30 = util$1.bytesFromStringArray,\n    util_31 = util$1.isString,\n    util_32 = util$1.isBoolean,\n    util_33 = util$1.isNumber,\n    util_34 = util$1.inferDtype,\n    util_35 = util$1.isFunction,\n    util_36 = util$1.nearestDivisor,\n    util_37 = util$1.computeStrides,\n    util_38 = util$1.toTypedArray,\n    util_39 = util$1.toNestedArray,\n    util_40 = util$1.makeOnesTypedArray,\n    util_41 = util$1.makeZerosTypedArray,\n    util_42 = util$1.now,\n    util_43 = util$1.monitorPromisesProgress,\n    tensor_format = createCommonjsModule(function (t, e) {\n  Object.defineProperty(e, \"__esModule\", {\n    value: !0\n  });\n  var r = 20,\n      n = 3,\n      o = 7;\n\n  function i(t, e) {\n    var r;\n    return r = Array.isArray(t) ? parseFloat(t[0].toFixed(o)) + \" + \" + parseFloat(t[1].toFixed(o)) + \"j\" : util$1.isString(t) ? \"'\" + t + \"'\" : parseFloat(t.toFixed(o)).toString(), util$1.rightPad(r, e);\n  }\n\n  function s(t) {\n    for (var e = [], r = 0; r < t.length; r += 2) {\n      e.push([t[r], t[r + 1]]);\n    }\n\n    return e;\n  }\n\n  e.tensorToString = function (t, e, o, a) {\n    var u = util$1.computeStrides(e),\n        h = function (t, e, r, n) {\n      var o = util$1.sizeFromShape(e),\n          a = n[n.length - 1],\n          u = new Array(a).fill(0),\n          h = e.length,\n          c = \"complex64\" === r ? s(t) : t;\n      if (h > 1) for (var l = 0; l < o / a; l++) {\n        for (var f = l * a, p = 0; p < a; p++) {\n          u[p] = Math.max(u[p], i(c[f + p], 0).length);\n        }\n      }\n      return u;\n    }(t, e, o, u),\n        c = e.length,\n        l = function t(e, o, a, u, h, c) {\n      void 0 === c && (c = !0);\n      var l = \"complex64\" === a ? 2 : 1,\n          f = o[0],\n          p = o.length;\n\n      if (0 === p) {\n        if (\"complex64\" === a) {\n          var d = s(e);\n          return [i(d[0], 0)];\n        }\n\n        return [e[0].toString()];\n      }\n\n      if (1 === p) {\n        if (f > r) {\n          var y = n * l,\n              m = Array.from(e.slice(0, y)),\n              v = Array.from(e.slice(f - n * l, f));\n          return \"complex64\" === a && (m = s(m), v = s(v)), [\"[\" + m.map(function (t, e) {\n            return i(t, h[e]);\n          }).join(\", \") + \", ..., \" + v.map(function (t, e) {\n            return i(t, h[f - n + e]);\n          }).join(\", \") + \"]\"];\n        }\n\n        var w = \"complex64\" === a ? s(e) : Array.from(e);\n        return [\"[\" + w.map(function (t, e) {\n          return i(t, h[e]);\n        }).join(\", \") + \"]\"];\n      }\n\n      var _ = o.slice(1),\n          g = u.slice(1),\n          b = u[0] * l,\n          I = [];\n\n      if (f > r) {\n        for (var x = 0; x < n; x++) {\n          var S = x * b,\n              D = S + b;\n          I.push.apply(I, t(e.slice(S, D), _, a, g, h, !1));\n        }\n\n        I.push(\"...\");\n\n        for (var x = f - n; x < f; x++) {\n          var S = x * b,\n              D = S + b;\n          I.push.apply(I, t(e.slice(S, D), _, a, g, h, x === f - 1));\n        }\n      } else for (var x = 0; x < f; x++) {\n        var S = x * b,\n            D = S + b;\n        I.push.apply(I, t(e.slice(S, D), _, a, g, h, x === f - 1));\n      }\n\n      var T = 2 === p ? \",\" : \"\";\n      I[0] = \"[\" + I[0] + T;\n\n      for (var x = 1; x < I.length - 1; x++) {\n        I[x] = \" \" + I[x] + T;\n      }\n\n      for (var E = \",\\n\", x = 2; x < p; x++) {\n        E += \"\\n\";\n      }\n\n      return I[I.length - 1] = \" \" + I[I.length - 1] + \"]\" + (c ? \"\" : E), I;\n    }(t, e, o, u, h),\n        f = [\"Tensor\"];\n\n    return a && (f.push(\"  dtype: \" + o), f.push(\"  rank: \" + c), f.push(\"  shape: [\" + e + \"]\"), f.push(\"  values:\")), f.push(l.map(function (t) {\n      return \"    \" + t;\n    }).join(\"\\n\")), f.join(\"\\n\");\n  };\n});\nunwrapExports(tensor_format);\nvar tensor_format_1 = tensor_format.tensorToString,\n    tensor = createCommonjsModule(function (t, e) {\n  var r,\n      n = commonjsGlobal && commonjsGlobal.__extends || (r = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (t, e) {\n    t.__proto__ = e;\n  } || function (t, e) {\n    for (var r in e) {\n      e.hasOwnProperty(r) && (t[r] = e[r]);\n    }\n  }, function (t, e) {\n    function n() {\n      this.constructor = t;\n    }\n\n    r(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());\n  }),\n      o = commonjsGlobal && commonjsGlobal.__awaiter || function (t, e, r, n) {\n    return new (r || (r = Promise))(function (o, i) {\n      function s(t) {\n        try {\n          u(n.next(t));\n        } catch (t) {\n          i(t);\n        }\n      }\n\n      function a(t) {\n        try {\n          u(n.throw(t));\n        } catch (t) {\n          i(t);\n        }\n      }\n\n      function u(t) {\n        t.done ? o(t.value) : new r(function (e) {\n          e(t.value);\n        }).then(s, a);\n      }\n\n      u((n = n.apply(t, e || [])).next());\n    });\n  },\n      i = commonjsGlobal && commonjsGlobal.__generator || function (t, e) {\n    var r,\n        n,\n        o,\n        i,\n        s = {\n      label: 0,\n      sent: function sent() {\n        if (1 & o[0]) throw o[1];\n        return o[1];\n      },\n      trys: [],\n      ops: []\n    };\n    return i = {\n      next: a(0),\n      throw: a(1),\n      return: a(2)\n    }, \"function\" == typeof Symbol && (i[Symbol.iterator] = function () {\n      return this;\n    }), i;\n\n    function a(i) {\n      return function (a) {\n        return function (i) {\n          if (r) throw new TypeError(\"Generator is already executing.\");\n\n          for (; s;) {\n            try {\n              if (r = 1, n && (o = 2 & i[0] ? n.return : i[0] ? n.throw || ((o = n.return) && o.call(n), 0) : n.next) && !(o = o.call(n, i[1])).done) return o;\n\n              switch (n = 0, o && (i = [2 & i[0], o.value]), i[0]) {\n                case 0:\n                case 1:\n                  o = i;\n                  break;\n\n                case 4:\n                  return s.label++, {\n                    value: i[1],\n                    done: !1\n                  };\n\n                case 5:\n                  s.label++, n = i[1], i = [0];\n                  continue;\n\n                case 7:\n                  i = s.ops.pop(), s.trys.pop();\n                  continue;\n\n                default:\n                  if (!(o = (o = s.trys).length > 0 && o[o.length - 1]) && (6 === i[0] || 2 === i[0])) {\n                    s = 0;\n                    continue;\n                  }\n\n                  if (3 === i[0] && (!o || i[1] > o[0] && i[1] < o[3])) {\n                    s.label = i[1];\n                    break;\n                  }\n\n                  if (6 === i[0] && s.label < o[1]) {\n                    s.label = o[1], o = i;\n                    break;\n                  }\n\n                  if (o && s.label < o[2]) {\n                    s.label = o[2], s.ops.push(i);\n                    break;\n                  }\n\n                  o[2] && s.ops.pop(), s.trys.pop();\n                  continue;\n              }\n\n              i = e.call(t, s);\n            } catch (t) {\n              i = [6, t], n = 0;\n            } finally {\n              r = o = 0;\n            }\n          }\n\n          if (5 & i[0]) throw i[1];\n          return {\n            value: i[0] ? i[1] : void 0,\n            done: !0\n          };\n        }([i, a]);\n      };\n    }\n  };\n\n  Object.defineProperty(e, \"__esModule\", {\n    value: !0\n  });\n\n  var s = util$1,\n      a = function () {\n    function t(t, e, r) {\n      if (this.dtype = e, this.shape = t.slice(), this.size = util$1.sizeFromShape(t), null != r) {\n        var n = r.length;\n        util$1.assert(n === this.size, \"Length of values '\" + n + \"' does not match the size inferred by the shape '\" + this.size + \"'.\");\n      }\n\n      if (\"complex64\" === e) throw new Error(\"complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).\");\n      this.values = r || util$1.getArrayFromDType(e, util$1.sizeFromShape(this.shape)), this.strides = s.computeStrides(t);\n    }\n\n    return t.prototype.set = function (t) {\n      for (var e = [], r = 1; r < arguments.length; r++) {\n        e[r - 1] = arguments[r];\n      }\n\n      0 === e.length && (e = [0]), util$1.assert(e.length === this.rank, \"The number of provided coordinates (\" + e.length + \") must match the rank (\" + this.rank + \")\");\n      var n = this.locToIndex(e);\n      this.values[n] = t;\n    }, t.prototype.get = function () {\n      for (var t = [], e = 0; e < arguments.length; e++) {\n        t[e] = arguments[e];\n      }\n\n      0 === t.length && (t = [0]);\n\n      for (var r = t[t.length - 1], n = 0; n < t.length - 1; ++n) {\n        r += this.strides[n] * t[n];\n      }\n\n      return this.values[r];\n    }, t.prototype.locToIndex = function (t) {\n      if (0 === this.rank) return 0;\n      if (1 === this.rank) return t[0];\n\n      for (var e = t[t.length - 1], r = 0; r < t.length - 1; ++r) {\n        e += this.strides[r] * t[r];\n      }\n\n      return e;\n    }, t.prototype.indexToLoc = function (t) {\n      if (0 === this.rank) return [];\n      if (1 === this.rank) return [t];\n\n      for (var e = new Array(this.shape.length), r = 0; r < e.length - 1; ++r) {\n        e[r] = Math.floor(t / this.strides[r]), t -= e[r] * this.strides[r];\n      }\n\n      return e[e.length - 1] = t, e;\n    }, Object.defineProperty(t.prototype, \"rank\", {\n      get: function get() {\n        return this.shape.length;\n      },\n      enumerable: !0,\n      configurable: !0\n    }), t.prototype.toTensor = function () {\n      return l.make(this.shape, {\n        values: this.values\n      }, this.dtype);\n    }, t;\n  }();\n\n  e.TensorBuffer = a;\n  var u = null,\n      h = null,\n      c = null;\n  e.setTensorTracker = function (t) {\n    u = t;\n  }, e.setOpHandler = function (t) {\n    h = t;\n  }, e.setDeprecationWarningFn = function (t) {\n    c = t;\n  };\n\n  var l = function () {\n    function t(t, e, r, n) {\n      this.isDisposedInternal = !1, this.shape = t.slice(), this.dtype = e || \"float32\", this.size = util$1.sizeFromShape(t), this.strides = s.computeStrides(t), this.dataId = null != n ? n : {}, this.id = u().nextTensorId(), this.rankType = this.rank < 5 ? this.rank.toString() : \"higher\", u().registerTensor(this), null != r && u().write(this.dataId, r);\n    }\n\n    return t.make = function (e, r, n) {\n      return new t(e, n, r.values, r.dataId);\n    }, t.prototype.flatten = function () {\n      return this.throwIfDisposed(), this.as1D();\n    }, t.prototype.asScalar = function () {\n      return this.throwIfDisposed(), util$1.assert(1 === this.size, \"The array must have only 1 element.\"), this.reshape([]);\n    }, t.prototype.as1D = function () {\n      return this.throwIfDisposed(), this.reshape([this.size]);\n    }, t.prototype.as2D = function (t, e) {\n      return this.throwIfDisposed(), this.reshape([t, e]);\n    }, t.prototype.as3D = function (t, e, r) {\n      return this.throwIfDisposed(), this.reshape([t, e, r]);\n    }, t.prototype.as4D = function (t, e, r, n) {\n      return this.throwIfDisposed(), this.reshape([t, e, r, n]);\n    }, t.prototype.as5D = function (t, e, r, n, o) {\n      return this.throwIfDisposed(), this.reshape([t, e, r, n, o]);\n    }, t.prototype.asType = function (t) {\n      return this.throwIfDisposed(), h.cast(this, t);\n    }, Object.defineProperty(t.prototype, \"rank\", {\n      get: function get() {\n        return this.shape.length;\n      },\n      enumerable: !0,\n      configurable: !0\n    }), t.prototype.get = function () {\n      for (var t = [], e = 0; e < arguments.length; e++) {\n        t[e] = arguments[e];\n      }\n\n      c(\"Tensor.get() is deprecated. Use Tensor.array() and native array indexing instead.\"), util$1.assert(t.length === this.rank, \"Number of coordinates in get() must match the rank of the tensor\"), util$1.assert(\"complex64\" !== this.dtype, \"Tensor.get() is not supported for complex64 tensors yet.\"), this.throwIfDisposed(), 0 === t.length && (t = [0]);\n\n      for (var r = t[t.length - 1], n = 0; n < t.length - 1; ++n) {\n        r += this.strides[n] * t[n];\n      }\n\n      return this.dataSync()[r];\n    }, t.prototype.buffer = function () {\n      return c(\"Tensor.buffer() is renamed to Tensor.bufferSync() in TensorFlow.js 1.0 and Tensor.buffer() will become an async function.\"), h.buffer(this.shape, this.dtype, this.dataSync());\n    }, t.prototype.bufferSync = function () {\n      return h.buffer(this.shape, this.dtype, this.dataSync());\n    }, t.prototype.array = function () {\n      return o(this, void 0, void 0, function () {\n        var t, e;\n        return i(this, function (r) {\n          switch (r.label) {\n            case 0:\n              return t = s.toNestedArray, e = [this.shape], [4, this.data()];\n\n            case 1:\n              return [2, t.apply(void 0, e.concat([r.sent()]))];\n          }\n        });\n      });\n    }, t.prototype.arraySync = function () {\n      return s.toNestedArray(this.shape, this.dataSync());\n    }, t.prototype.data = function () {\n      return o(this, void 0, void 0, function () {\n        return i(this, function (t) {\n          return this.throwIfDisposed(), [2, u().read(this.dataId)];\n        });\n      });\n    }, t.prototype.dataSync = function () {\n      return this.throwIfDisposed(), u().readSync(this.dataId);\n    }, t.prototype.dispose = function () {\n      this.isDisposed || (u().disposeTensor(this), this.isDisposedInternal = !0);\n    }, Object.defineProperty(t.prototype, \"isDisposed\", {\n      get: function get() {\n        return this.isDisposedInternal;\n      },\n      enumerable: !0,\n      configurable: !0\n    }), t.prototype.throwIfDisposed = function () {\n      if (this.isDisposed) throw new Error(\"Tensor is disposed.\");\n    }, t.prototype.toFloat = function () {\n      return this.asType(\"float32\");\n    }, t.prototype.toInt = function () {\n      return this.asType(\"int32\");\n    }, t.prototype.toBool = function () {\n      return this.asType(\"bool\");\n    }, t.prototype.print = function (t) {\n      return void 0 === t && (t = !1), h.print(this, t);\n    }, t.prototype.reshape = function (t) {\n      return this.throwIfDisposed(), h.reshape(this, t);\n    }, t.prototype.reshapeAs = function (t) {\n      return this.throwIfDisposed(), this.reshape(t.shape);\n    }, t.prototype.expandDims = function (t) {\n      return void 0 === t && (t = 0), h.expandDims(this, t);\n    }, t.prototype.cumsum = function (t, e, r) {\n      return void 0 === t && (t = 0), void 0 === e && (e = !1), void 0 === r && (r = !1), h.cumsum(this, t, e, r);\n    }, t.prototype.squeeze = function (t) {\n      return this.throwIfDisposed(), h.squeeze(this, t);\n    }, t.prototype.clone = function () {\n      return this.throwIfDisposed(), h.clone(this);\n    }, t.prototype.oneHot = function (t, e, r) {\n      return this.throwIfDisposed(), h.oneHot(this, t, e, r);\n    }, t.prototype.toString = function (t) {\n      void 0 === t && (t = !1);\n      var e = this.dataSync();\n      return tensor_format.tensorToString(e, this.shape, this.dtype, t);\n    }, t.prototype.tile = function (t) {\n      return this.throwIfDisposed(), h.tile(this, t);\n    }, t.prototype.gather = function (t, e) {\n      return void 0 === e && (e = 0), this.throwIfDisposed(), h.gather(this, t, e);\n    }, t.prototype.matMul = function (t, e, r) {\n      return void 0 === e && (e = !1), void 0 === r && (r = !1), this.throwIfDisposed(), h.matMul(this, t, e, r);\n    }, t.prototype.dot = function (t) {\n      return this.throwIfDisposed(), h.dot(this, t);\n    }, t.prototype.norm = function (t, e, r) {\n      return void 0 === t && (t = \"euclidean\"), void 0 === e && (e = null), void 0 === r && (r = !1), this.throwIfDisposed(), h.norm(this, t, e, r);\n    }, t.prototype.slice = function (t, e) {\n      return this.throwIfDisposed(), h.slice(this, t, e);\n    }, t.prototype.reverse = function (t) {\n      return this.throwIfDisposed(), h.reverse(this, t);\n    }, t.prototype.concat = function (e, r) {\n      return void 0 === r && (r = 0), this.throwIfDisposed(), e instanceof t && (e = [e]), h.concat([this].concat(e), r);\n    }, t.prototype.split = function (t, e) {\n      return void 0 === e && (e = 0), this.throwIfDisposed(), h.split(this, t, e);\n    }, t.prototype.stack = function (t, e) {\n      return void 0 === e && (e = 0), h.stack([this, t], e);\n    }, t.prototype.unstack = function (t) {\n      return void 0 === t && (t = 0), h.unstack(this, t);\n    }, t.prototype.pad = function (t, e) {\n      return void 0 === e && (e = 0), h.pad(this, t, e);\n    }, t.prototype.batchNormalization = function (t, e, r, n, o) {\n      return void 0 === r && (r = .001), c(\"tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon\"), this.batchNorm(t, e, o, n, r);\n    }, t.prototype.batchNorm = function (t, e, r, n, o) {\n      return void 0 === o && (o = .001), this.throwIfDisposed(), h.batchNorm(this, t, e, r, n, o);\n    }, t.prototype.all = function (t, e) {\n      return void 0 === t && (t = null), void 0 === e && (e = !1), this.throwIfDisposed(), h.all(this, t, e);\n    }, t.prototype.any = function (t, e) {\n      return void 0 === t && (t = null), void 0 === e && (e = !1), this.throwIfDisposed(), h.any(this, t, e);\n    }, t.prototype.logSumExp = function (t, e) {\n      return void 0 === t && (t = null), void 0 === e && (e = !1), this.throwIfDisposed(), h.logSumExp(this, t, e);\n    }, t.prototype.sum = function (t, e) {\n      return void 0 === t && (t = null), void 0 === e && (e = !1), this.throwIfDisposed(), h.sum(this, t, e);\n    }, t.prototype.prod = function (t, e) {\n      return void 0 === t && (t = null), void 0 === e && (e = !1), this.throwIfDisposed(), h.prod(this, t, e);\n    }, t.prototype.mean = function (t, e) {\n      return void 0 === t && (t = null), void 0 === e && (e = !1), this.throwIfDisposed(), h.mean(this, t, e);\n    }, t.prototype.min = function (t, e) {\n      return void 0 === t && (t = null), void 0 === e && (e = !1), this.throwIfDisposed(), h.min(this, t, e);\n    }, t.prototype.max = function (t, e) {\n      return void 0 === t && (t = null), void 0 === e && (e = !1), this.throwIfDisposed(), h.max(this, t, e);\n    }, t.prototype.argMin = function (t) {\n      return void 0 === t && (t = null), this.throwIfDisposed(), h.argMin(this, t);\n    }, t.prototype.argMax = function (t) {\n      return void 0 === t && (t = null), this.throwIfDisposed(), h.argMax(this, t);\n    }, t.prototype.cast = function (t) {\n      return this.throwIfDisposed(), h.cast(this, t);\n    }, t.prototype.add = function (t) {\n      return this.throwIfDisposed(), h.add(this, t);\n    }, t.prototype.addStrict = function (t) {\n      return this.throwIfDisposed(), h.addStrict(this, t);\n    }, t.prototype.atan2 = function (t) {\n      return this.throwIfDisposed(), h.atan2(this, t);\n    }, t.prototype.sub = function (t) {\n      return this.throwIfDisposed(), h.sub(this, t);\n    }, t.prototype.subStrict = function (t) {\n      return this.throwIfDisposed(), h.subStrict(this, t);\n    }, t.prototype.pow = function (t) {\n      return this.throwIfDisposed(), h.pow(this, t);\n    }, t.prototype.powStrict = function (t) {\n      return this.throwIfDisposed(), h.powStrict(this, t);\n    }, t.prototype.mul = function (t) {\n      return this.throwIfDisposed(), h.mul(this, t);\n    }, t.prototype.mulStrict = function (t) {\n      return this.throwIfDisposed(), h.mulStrict(this, t);\n    }, t.prototype.div = function (t) {\n      return this.throwIfDisposed(), h.div(this, t);\n    }, t.prototype.floorDiv = function (t) {\n      return this.throwIfDisposed(), h.floorDiv(this, t);\n    }, t.prototype.divStrict = function (t) {\n      return this.throwIfDisposed(), h.divStrict(this, t);\n    }, t.prototype.minimum = function (t) {\n      return this.throwIfDisposed(), h.minimum(this, t);\n    }, t.prototype.minimumStrict = function (t) {\n      return this.throwIfDisposed(), h.minimumStrict(this, t);\n    }, t.prototype.maximum = function (t) {\n      return this.throwIfDisposed(), h.maximum(this, t);\n    }, t.prototype.maximumStrict = function (t) {\n      return this.throwIfDisposed(), h.maximumStrict(this, t);\n    }, t.prototype.mod = function (t) {\n      return this.throwIfDisposed(), h.mod(this, t);\n    }, t.prototype.modStrict = function (t) {\n      return this.throwIfDisposed(), h.modStrict(this, t);\n    }, t.prototype.squaredDifference = function (t) {\n      return this.throwIfDisposed(), h.squaredDifference(this, t);\n    }, t.prototype.squaredDifferenceStrict = function (t) {\n      return this.throwIfDisposed(), h.squaredDifferenceStrict(this, t);\n    }, t.prototype.transpose = function (t) {\n      return this.throwIfDisposed(), h.transpose(this, t);\n    }, t.prototype.notEqual = function (t) {\n      return this.throwIfDisposed(), h.notEqual(this, t);\n    }, t.prototype.notEqualStrict = function (t) {\n      return this.throwIfDisposed(), h.notEqualStrict(this, t);\n    }, t.prototype.less = function (t) {\n      return this.throwIfDisposed(), h.less(this, t);\n    }, t.prototype.lessStrict = function (t) {\n      return this.throwIfDisposed(), h.lessStrict(this, t);\n    }, t.prototype.equal = function (t) {\n      return this.throwIfDisposed(), h.equal(this, t);\n    }, t.prototype.equalStrict = function (t) {\n      return this.throwIfDisposed(), h.equalStrict(this, t);\n    }, t.prototype.lessEqual = function (t) {\n      return this.throwIfDisposed(), h.lessEqual(this, t);\n    }, t.prototype.lessEqualStrict = function (t) {\n      return this.throwIfDisposed(), h.lessEqualStrict(this, t);\n    }, t.prototype.greater = function (t) {\n      return this.throwIfDisposed(), h.greater(this, t);\n    }, t.prototype.greaterStrict = function (t) {\n      return this.throwIfDisposed(), h.greaterStrict(this, t);\n    }, t.prototype.greaterEqual = function (t) {\n      return this.throwIfDisposed(), h.greaterEqual(this, t);\n    }, t.prototype.greaterEqualStrict = function (t) {\n      return this.throwIfDisposed(), h.greaterEqualStrict(this, t);\n    }, t.prototype.logicalAnd = function (t) {\n      return this.throwIfDisposed(), h.logicalAnd(this, t);\n    }, t.prototype.logicalOr = function (t) {\n      return this.throwIfDisposed(), h.logicalOr(this, t);\n    }, t.prototype.logicalNot = function () {\n      return this.throwIfDisposed(), h.logicalNot(this);\n    }, t.prototype.logicalXor = function (t) {\n      return this.throwIfDisposed(), h.logicalXor(this, t);\n    }, t.prototype.where = function (t, e) {\n      return this.throwIfDisposed(), h.where(t, this, e);\n    }, t.prototype.neg = function () {\n      return this.throwIfDisposed(), h.neg(this);\n    }, t.prototype.ceil = function () {\n      return this.throwIfDisposed(), h.ceil(this);\n    }, t.prototype.floor = function () {\n      return this.throwIfDisposed(), h.floor(this);\n    }, t.prototype.sign = function () {\n      return this.throwIfDisposed(), h.sign(this);\n    }, t.prototype.exp = function () {\n      return this.throwIfDisposed(), h.exp(this);\n    }, t.prototype.expm1 = function () {\n      return this.throwIfDisposed(), h.expm1(this);\n    }, t.prototype.log = function () {\n      return this.throwIfDisposed(), h.log(this);\n    }, t.prototype.log1p = function () {\n      return this.throwIfDisposed(), h.log1p(this);\n    }, t.prototype.sqrt = function () {\n      return this.throwIfDisposed(), h.sqrt(this);\n    }, t.prototype.rsqrt = function () {\n      return this.throwIfDisposed(), h.rsqrt(this);\n    }, t.prototype.square = function () {\n      return this.throwIfDisposed(), h.square(this);\n    }, t.prototype.reciprocal = function () {\n      return this.throwIfDisposed(), h.reciprocal(this);\n    }, t.prototype.abs = function () {\n      return this.throwIfDisposed(), h.abs(this);\n    }, t.prototype.clipByValue = function (t, e) {\n      return this.throwIfDisposed(), h.clipByValue(this, t, e);\n    }, t.prototype.relu = function () {\n      return this.throwIfDisposed(), h.relu(this);\n    }, t.prototype.elu = function () {\n      return this.throwIfDisposed(), h.elu(this);\n    }, t.prototype.selu = function () {\n      return this.throwIfDisposed(), h.selu(this);\n    }, t.prototype.leakyRelu = function (t) {\n      return void 0 === t && (t = .2), this.throwIfDisposed(), h.leakyRelu(this, t);\n    }, t.prototype.prelu = function (t) {\n      return this.throwIfDisposed(), h.prelu(this, t);\n    }, t.prototype.sigmoid = function () {\n      return this.throwIfDisposed(), h.sigmoid(this);\n    }, t.prototype.logSigmoid = function () {\n      return this.throwIfDisposed(), h.logSigmoid(this);\n    }, t.prototype.softplus = function () {\n      return this.throwIfDisposed(), h.softplus(this);\n    }, t.prototype.zerosLike = function () {\n      return this.throwIfDisposed(), h.zerosLike(this);\n    }, t.prototype.onesLike = function () {\n      return this.throwIfDisposed(), h.onesLike(this);\n    }, t.prototype.sin = function () {\n      return this.throwIfDisposed(), h.sin(this);\n    }, t.prototype.cos = function () {\n      return this.throwIfDisposed(), h.cos(this);\n    }, t.prototype.tan = function () {\n      return this.throwIfDisposed(), h.tan(this);\n    }, t.prototype.asin = function () {\n      return this.throwIfDisposed(), h.asin(this);\n    }, t.prototype.acos = function () {\n      return this.throwIfDisposed(), h.acos(this);\n    }, t.prototype.atan = function () {\n      return this.throwIfDisposed(), h.atan(this);\n    }, t.prototype.sinh = function () {\n      return this.throwIfDisposed(), h.sinh(this);\n    }, t.prototype.cosh = function () {\n      return this.throwIfDisposed(), h.cosh(this);\n    }, t.prototype.tanh = function () {\n      return this.throwIfDisposed(), h.tanh(this);\n    }, t.prototype.asinh = function () {\n      return this.throwIfDisposed(), h.asinh(this);\n    }, t.prototype.acosh = function () {\n      return this.throwIfDisposed(), h.acosh(this);\n    }, t.prototype.atanh = function () {\n      return this.throwIfDisposed(), h.atanh(this);\n    }, t.prototype.erf = function () {\n      return this.throwIfDisposed(), h.erf(this);\n    }, t.prototype.round = function () {\n      return this.throwIfDisposed(), h.round(this);\n    }, t.prototype.step = function (t) {\n      return void 0 === t && (t = 0), this.throwIfDisposed(), h.step(this, t);\n    }, t.prototype.softmax = function (t) {\n      return void 0 === t && (t = -1), this.throwIfDisposed(), h.softmax(this, t);\n    }, t.prototype.logSoftmax = function (t) {\n      return void 0 === t && (t = -1), this.throwIfDisposed(), h.logSoftmax(this, t);\n    }, t.prototype.resizeBilinear = function (t, e) {\n      return void 0 === e && (e = !1), this.throwIfDisposed(), h.image.resizeBilinear(this, t, e);\n    }, t.prototype.resizeNearestNeighbor = function (t, e) {\n      return void 0 === e && (e = !1), this.throwIfDisposed(), h.image.resizeNearestNeighbor(this, t, e);\n    }, t.prototype.conv1d = function (t, e, r, n, o, i) {\n      return void 0 === n && (n = \"NWC\"), void 0 === o && (o = 1), this.throwIfDisposed(), h.conv1d(this, t, e, r, n, o, i);\n    }, t.prototype.conv2d = function (t, e, r, n, o, i) {\n      return void 0 === n && (n = \"NHWC\"), void 0 === o && (o = [1, 1]), this.throwIfDisposed(), h.conv2d(this, t, e, r, n, o, i);\n    }, t.prototype.conv2dTranspose = function (t, e, r, n, o) {\n      return this.throwIfDisposed(), h.conv2dTranspose(this, t, e, r, n, o);\n    }, t.prototype.depthwiseConv2D = function (t, e, r, n, o, i) {\n      return void 0 === n && (n = \"NHWC\"), void 0 === o && (o = [1, 1]), this.throwIfDisposed(), h.depthwiseConv2d(this, t, e, r, n, o, i);\n    }, t.prototype.separableConv2d = function (t, e, r, n, o, i) {\n      return void 0 === o && (o = [1, 1]), void 0 === i && (i = \"NHWC\"), this.throwIfDisposed(), h.separableConv2d(this, t, e, r, n, o, i);\n    }, t.prototype.avgPool = function (t, e, r, n) {\n      return this.throwIfDisposed(), h.avgPool(this, t, e, r, n);\n    }, t.prototype.maxPool = function (t, e, r, n) {\n      return this.throwIfDisposed(), h.maxPool(this, t, e, r, n);\n    }, t.prototype.localResponseNormalization = function (t, e, r, n) {\n      return void 0 === t && (t = 5), void 0 === e && (e = 1), void 0 === r && (r = 1), void 0 === n && (n = .5), h.localResponseNormalization(this, t, e, r, n);\n    }, t.prototype.pool = function (t, e, r, n, o) {\n      return this.throwIfDisposed(), h.pool(this, t, e, r, n, o);\n    }, t.prototype.variable = function (t, e, r) {\n      return void 0 === t && (t = !0), this.throwIfDisposed(), f.variable(this, t, e, r);\n    }, t.prototype.unsortedSegmentSum = function (t, e) {\n      return this.throwIfDisposed(), h.unsortedSegmentSum(this, t, e);\n    }, t.prototype.batchToSpaceND = function (t, e) {\n      return this.throwIfDisposed(), h.batchToSpaceND(this, t, e);\n    }, t.prototype.spaceToBatchND = function (t, e) {\n      return this.throwIfDisposed(), h.spaceToBatchND(this, t, e);\n    }, t.prototype.topk = function (t, e) {\n      return void 0 === t && (t = 1), void 0 === e && (e = !0), this.throwIfDisposed(), h.topk(this, t, e);\n    }, t.prototype.stridedSlice = function (t, e, r, n, o, i, s, a) {\n      return void 0 === n && (n = 0), void 0 === o && (o = 0), void 0 === i && (i = 0), void 0 === s && (s = 0), void 0 === a && (a = 0), this.throwIfDisposed(), h.stridedSlice(this, t, e, r, n, o, i, s, a);\n    }, t.prototype.depthToSpace = function (t, e) {\n      return this.throwIfDisposed(), h.depthToSpace(this, t, e);\n    }, t.prototype.fft = function () {\n      return this.throwIfDisposed(), h.spectral.fft(this);\n    }, t.prototype.ifft = function () {\n      return this.throwIfDisposed(), h.spectral.ifft(this);\n    }, t.prototype.rfft = function () {\n      return this.throwIfDisposed(), h.spectral.rfft(this);\n    }, t.prototype.irfft = function () {\n      return this.throwIfDisposed(), h.spectral.irfft(this);\n    }, t;\n  }();\n\n  e.Tensor = l, Object.defineProperty(l, Symbol.hasInstance, {\n    value: function value(t) {\n      return !!t && null != t.dataId && null != t.shape && null != t.dtype;\n    }\n  });\n\n  var f = function (t) {\n    function e(e, r, n) {\n      void 0 === r && (r = !0);\n      var o = t.call(this, e.shape, e.dtype, null, e.dataId) || this;\n      o.trainable = r, o.name = n, null == o.name && (o.name = u().nextVariableId().toString());\n\n      try {\n        u().registerVariable(o);\n      } catch (t) {\n        throw u().disposeTensor(o), t;\n      }\n\n      return o;\n    }\n\n    return n(e, t), e.variable = function (t, r, n, o) {\n      return void 0 === r && (r = !0), null != o && o !== t.dtype && (t = t.asType(o)), new e(t, r, n);\n    }, e.prototype.assign = function (t) {\n      if (t.dtype !== this.dtype) throw new Error(\"dtype of the new value (\" + t.dtype + \") and previous value (\" + this.dtype + \") must match\");\n      if (!util$1.arraysEqual(t.shape, this.shape)) throw new Error(\"shape of the new value (\" + t.shape + \") and previous value (\" + this.shape + \") must match\");\n      u().disposeTensor(this), this.dataId = t.dataId, u().registerTensor(this);\n    }, e;\n  }(l);\n\n  e.Variable = f, Object.defineProperty(f, Symbol.hasInstance, {\n    value: function value(t) {\n      return t instanceof l && null != t.assign && t.assign instanceof Function;\n    }\n  });\n  var p = f.variable;\n  e.variable = p;\n});\nunwrapExports(tensor);\nvar tensor_1 = tensor.TensorBuffer,\n    tensor_2 = tensor.setTensorTracker,\n    tensor_3 = tensor.setOpHandler,\n    tensor_4 = tensor.setDeprecationWarningFn,\n    tensor_5 = tensor.Tensor,\n    tensor_6 = tensor.Variable,\n    tensor_7 = tensor.variable,\n    types = createCommonjsModule(function (t, e) {\n  var r, n, o, i;\n  Object.defineProperty(e, \"__esModule\", {\n    value: !0\n  }), function (t) {\n    t.R0 = \"R0\", t.R1 = \"R1\", t.R2 = \"R2\", t.R3 = \"R3\", t.R4 = \"R4\", t.R5 = \"R5\", t.R6 = \"R6\";\n  }(e.Rank || (e.Rank = {})), function (t) {\n    t.float32 = \"float32\", t.int32 = \"int32\", t.bool = \"int32\", t.complex64 = \"complex64\";\n  }(r || (r = {})), function (t) {\n    t.float32 = \"float32\", t.int32 = \"int32\", t.bool = \"bool\", t.complex64 = \"complex64\";\n  }(n || (n = {})), function (t) {\n    t.float32 = \"float32\", t.int32 = \"float32\", t.bool = \"float32\", t.complex64 = \"complex64\";\n  }(o || (o = {})), function (t) {\n    t.float32 = \"complex64\", t.int32 = \"complex64\", t.bool = \"complex64\", t.complex64 = \"complex64\";\n  }(i || (i = {}));\n  var s = {\n    float32: o,\n    int32: r,\n    bool: n,\n    complex64: i\n  };\n\n  function a(t, e) {\n    if (\"string\" === t || \"string\" === e) {\n      if (\"string\" === t && \"string\" === e) return \"string\";\n      throw new Error(\"Can not upcast \" + t + \" with \" + e);\n    }\n\n    return s[t][e];\n  }\n\n  e.upcastType = a, e.sumOutType = function (t) {\n    return a(t, \"int32\");\n  };\n});\nunwrapExports(types);\nvar types_1 = types.Rank,\n    types_2 = types.upcastType,\n    types_3 = types.sumOutType,\n    tensor_util = createCommonjsModule(function (t, e) {\n  Object.defineProperty(e, \"__esModule\", {\n    value: !0\n  }), e.makeTypesMatch = function (t, e) {\n    if (t.dtype === e.dtype) return [t, e];\n    var r = types.upcastType(t.dtype, e.dtype);\n    return [t.cast(r), e.cast(r)];\n  }, e.assertTypesMatch = function (t, e) {\n    util$1.assert(t.dtype === e.dtype, \"The dtypes of the first(\" + t.dtype + \") and second(\" + e.dtype + \") input must match\");\n  }, e.isTensorInList = function (t, e) {\n    for (var r = 0; r < e.length; r++) {\n      if (e[r].id === t.id) return !0;\n    }\n\n    return !1;\n  }, e.flattenNameArrayMap = function (t, e) {\n    var r = [];\n    if (t instanceof tensor.Tensor) r.push(t);else for (var n = t, o = 0; o < e.length; o++) {\n      r.push(n[e[o]]);\n    }\n    return r;\n  }, e.unflattenToNameArrayMap = function (t, e) {\n    if (t.length !== e.length) throw new Error(\"Cannot unflatten Tensor[], keys and arrays are not of same length.\");\n\n    for (var r = {}, n = 0; n < t.length; n++) {\n      r[t[n]] = e[n];\n    }\n\n    return r;\n  }, e.getTensorsInContainer = function (t) {\n    var e = [];\n    return function t(e, r, n) {\n      if (null != e) if (e instanceof tensor.Tensor) r.push(e);else if (o = e, Array.isArray(o) || \"object\" == typeof o) {\n        var o,\n            i = e;\n\n        for (var s in i) {\n          var a = i[s];\n          n.has(a) || (n.add(a), t(a, r, n));\n        }\n      }\n    }(t, e, new Set()), e;\n  };\n});\nunwrapExports(tensor_util);\nvar tensor_util_1 = tensor_util.makeTypesMatch,\n    tensor_util_2 = tensor_util.assertTypesMatch,\n    tensor_util_3 = tensor_util.isTensorInList,\n    tensor_util_4 = tensor_util.flattenNameArrayMap,\n    tensor_util_5 = tensor_util.unflattenToNameArrayMap,\n    tensor_util_6 = tensor_util.getTensorsInContainer;\n\nfunction deepMapInternal(t, e, r, n) {\n  if (void 0 === r && (r = new Map()), void 0 === n && (n = new Set()), null == t) return null;\n  if (n.has(t)) throw new Error(\"Circular references are not supported.\");\n  if (r.has(t)) return r.get(t);\n  var o = e(t);\n  if (o.recurse && null !== o.value) throw new Error(\"A deep map function may not return both a value and recurse=true.\");\n\n  if (o.recurse) {\n    if (isIterable(t)) {\n      var i = Array.isArray(t) ? [] : {};\n\n      for (var s in n.add(t), t) {\n        var a = deepMapInternal(t[s], e, r, n);\n        i[s] = a;\n      }\n\n      return n.delete(t), i;\n    }\n\n    throw new Error(\"Can't recurse into non-iterable type: \" + t);\n  }\n\n  return r.set(t, o.value), o.value;\n}\n\nfunction deepZip(t, e) {\n  return void 0 === e && (e = zipToList), deepZipInternal(t, e);\n}\n\nfunction deepZipInternal(t, e, r) {\n  void 0 === r && (r = new Set());\n  var n = t[0];\n  if (r.has(n)) throw new Error(\"Circular references are not supported.\");\n  var o = e(t);\n  if (o.recurse && null !== o.value) throw new Error(\"A deep zip function may not return both a value and recurse=true.\");\n\n  if (o.recurse) {\n    if (isIterable(n)) {\n      var i = Array.isArray(n) ? [] : {};\n      r.add(n);\n\n      var s = function s(n) {\n        var o = deepZipInternal(t.map(function (t) {\n          return t[n];\n        }), e, r);\n        i[n] = o;\n      };\n\n      for (var a in n) {\n        s(a);\n      }\n\n      return r.delete(n), i;\n    }\n\n    throw new Error(\"Can't recurse into non-iterable type: \" + n);\n  }\n\n  return o.value;\n}\n\nfunction zipToList(t) {\n  return null === t ? null : isIterable(t[0]) ? {\n    value: null,\n    recurse: !0\n  } : {\n    value: t,\n    recurse: !1\n  };\n}\n\nfunction deepMapAndAwaitAll(t, e) {\n  return __awaiter(this, void 0, void 0, function () {\n    var r, n, o, i, s, a;\n    return __generator(this, function (u) {\n      switch (u.label) {\n        case 0:\n          r = new Map(), deepMapInternal(t, e, r), n = 0, o = Array.from(r.keys()), u.label = 1;\n\n        case 1:\n          return n < o.length ? (i = o[n], (s = r.get(i)) instanceof Promise ? [4, s] : [3, 3]) : [3, 4];\n\n        case 2:\n          a = u.sent(), r.set(i, a), u.label = 3;\n\n        case 3:\n          return n++, [3, 1];\n\n        case 4:\n          return [2, deepMapInternal(t, e, r)];\n      }\n    });\n  });\n}\n\nfunction isIterable(t) {\n  return null != t && (Array.isArray(t) || \"object\" == typeof t && !(t instanceof Tensor));\n}\n\nfunction isNumericArray(t) {\n  if (null == t) return !1;\n  if (!Array.isArray(t)) return !1;\n\n  for (var e in t) {\n    if (\"number\" != typeof t[e]) return !1;\n  }\n\n  return !0;\n}\n\nvar RingBuffer = function () {\n  function t(t) {\n    if (this.capacity = t, this.begin = 0, this.end = 0, t < 1) throw new RangeError(\"Can't create ring buffer of capacity < 1.\");\n    this.data = new Array(t), this.doubledCapacity = 2 * t;\n  }\n\n  return t.prototype.wrap = function (t) {\n    for (; t < 0;) {\n      t += this.doubledCapacity;\n    }\n\n    return t % this.doubledCapacity;\n  }, t.prototype.get = function (t) {\n    if (t < 0) throw new RangeError(\"Can't get item at a negative index.\");\n    return this.data[t % this.capacity];\n  }, t.prototype.set = function (t, e) {\n    if (t < 0) throw new RangeError(\"Can't set item at a negative index.\");\n    this.data[t % this.capacity] = e;\n  }, t.prototype.length = function () {\n    var t = this.end - this.begin;\n    return t < 0 && (t = this.doubledCapacity + t), t;\n  }, t.prototype.isFull = function () {\n    return this.length() === this.capacity;\n  }, t.prototype.isEmpty = function () {\n    return 0 === this.length();\n  }, t.prototype.push = function (t) {\n    if (this.isFull()) throw new RangeError(\"Ring buffer is full.\");\n    this.set(this.end, t), this.end = this.wrap(this.end + 1);\n  }, t.prototype.pushAll = function (t) {\n    for (var e = 0, r = t; e < r.length; e++) {\n      var n = r[e];\n      this.push(n);\n    }\n  }, t.prototype.pop = function () {\n    if (this.isEmpty()) throw new RangeError(\"Ring buffer is empty.\");\n    this.end = this.wrap(this.end - 1);\n    var t = this.get(this.end);\n    return this.set(this.end, void 0), t;\n  }, t.prototype.unshift = function (t) {\n    if (this.isFull()) throw new RangeError(\"Ring buffer is full.\");\n    this.begin = this.wrap(this.begin - 1), this.set(this.begin, t);\n  }, t.prototype.shift = function () {\n    if (this.isEmpty()) throw new RangeError(\"Ring buffer is empty.\");\n    var t = this.get(this.begin);\n    return this.set(this.begin, void 0), this.begin = this.wrap(this.begin + 1), t;\n  }, t.prototype.shuffleExcise = function (t) {\n    if (this.isEmpty()) throw new RangeError(\"Ring buffer is empty.\");\n    var e = this.wrap(this.begin + t),\n        r = this.get(e);\n    return this.set(e, this.pop()), r;\n  }, t;\n}(),\n    GrowingRingBuffer = function (t) {\n  function e() {\n    return t.call(this, e.INITIAL_CAPACITY) || this;\n  }\n\n  return __extends(e, t), e.prototype.isFull = function () {\n    return !1;\n  }, e.prototype.push = function (e) {\n    t.prototype.isFull.call(this) && this.expand(), t.prototype.push.call(this, e);\n  }, e.prototype.unshift = function (e) {\n    t.prototype.isFull.call(this) && this.expand(), t.prototype.unshift.call(this, e);\n  }, e.prototype.expand = function () {\n    for (var t = 2 * this.capacity, e = new Array(t), r = this.length(), n = 0; n < r; n++) {\n      e[n] = this.get(this.wrap(this.begin + n));\n    }\n\n    this.data = e, this.capacity = t, this.doubledCapacity = 2 * this.capacity, this.begin = 0, this.end = r;\n  }, e.INITIAL_CAPACITY = 32, e;\n}(RingBuffer);\n\nfunction iteratorFromItems(t) {\n  return new ArrayIterator(t);\n}\n\nfunction iteratorFromFunction(t) {\n  return new FunctionCallIterator(t);\n}\n\nfunction iteratorFromConcatenated(t, e) {\n  return new ChainedIterator(t, e);\n}\n\nfunction iteratorFromZipped(t, e) {\n  return void 0 === e && (e = ZipMismatchMode.FAIL), new ZipIterator(t, e);\n}\n\nvar ZipMismatchMode,\n    LazyIterator = function () {\n  function t() {}\n\n  return t.prototype.collect = function (t, e) {\n    return void 0 === t && (t = 1e3), void 0 === e && (e = 100), __awaiter(this, void 0, void 0, function () {\n      var r, n, o, i;\n      return __generator(this, function (s) {\n        switch (s.label) {\n          case 0:\n            return r = e > 0 ? this.prefetch(e) : this, n = [], o = 0, [4, r.next()];\n\n          case 1:\n            i = s.sent(), s.label = 2;\n\n          case 2:\n            return i.done ? [3, 4] : (n.push(i.value), ++o >= t ? [2, n] : [4, r.next()]);\n\n          case 3:\n            return i = s.sent(), [3, 2];\n\n          case 4:\n            return [2, n];\n        }\n      });\n    });\n  }, t.prototype.resolveFully = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var t;\n      return __generator(this, function (e) {\n        switch (e.label) {\n          case 0:\n            return [4, this.next()];\n\n          case 1:\n            t = e.sent(), e.label = 2;\n\n          case 2:\n            return t.done ? [3, 4] : [4, this.next()];\n\n          case 3:\n            return t = e.sent(), [3, 2];\n\n          case 4:\n            return [2];\n        }\n      });\n    });\n  }, t.prototype.resolveWhile = function (t) {\n    return __awaiter(this, void 0, void 0, function () {\n      var e, r;\n      return __generator(this, function (n) {\n        switch (n.label) {\n          case 0:\n            return [4, this.next()];\n\n          case 1:\n            e = n.sent(), r = t(e.value), n.label = 2;\n\n          case 2:\n            return e.done || !r ? [3, 4] : [4, this.next()];\n\n          case 3:\n            return e = n.sent(), r = t(e.value), [3, 2];\n\n          case 4:\n            return [2];\n        }\n      });\n    });\n  }, t.prototype.handleErrors = function (t) {\n    return new ErrorHandlingLazyIterator(this, t);\n  }, t.prototype.filter = function (t) {\n    return new FilterIterator(this, t);\n  }, t.prototype.map = function (t) {\n    return new MapIterator(this, t);\n  }, t.prototype.mapAsync = function (t) {\n    return new AsyncMapIterator(this, t);\n  }, t.prototype.serialMapAsync = function (t) {\n    return new AsyncMapIterator(this, t).serial();\n  }, t.prototype.flatmap = function (t) {\n    return new FlatmapIterator(this, t);\n  }, t.prototype.forEachAsync = function (t) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (e) {\n        return [2, this.map(t).resolveFully()];\n      });\n    });\n  }, t.prototype.serialForEach = function (t) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (e) {\n        return [2, this.serialMapAsync(t).resolveWhile(function (t) {\n          return !0 === t;\n        })];\n      });\n    });\n  }, t.prototype.rowMajorBatch = function (t, e) {\n    return void 0 === e && (e = !0), new RowMajorBatchIterator(this, t, e);\n  }, t.prototype.columnMajorBatch = function (t, e, r) {\n    return void 0 === e && (e = !0), void 0 === r && (r = zipToList), this.rowMajorBatch(t, e).map(function (t) {\n      return deepZip(t, r);\n    });\n  }, t.prototype.concatenate = function (t, e) {\n    return new ChainedIterator(iteratorFromItems([this, t]), e);\n  }, t.prototype.take = function (t) {\n    return t < 0 || null == t ? this : new TakeIterator(this, t);\n  }, t.prototype.skip = function (t) {\n    return t < 0 || null == t ? this : new SkipIterator(this, t);\n  }, t.prototype.prefetch = function (t) {\n    return new PrefetchIterator(this, t);\n  }, t.prototype.shuffle = function (t, e) {\n    return new ShuffleIterator(this, t, e);\n  }, t.prototype.serial = function () {\n    return new SerialIterator(this);\n  }, t;\n}(),\n    ArrayIterator = function (t) {\n  function e(e) {\n    var r = t.call(this) || this;\n    return r.items = e, r.trav = 0, r;\n  }\n\n  return __extends(e, t), e.prototype.summary = function () {\n    return \"Array of \" + this.items.length + \" items\";\n  }, e.prototype.next = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var t, e;\n      return __generator(this, function (r) {\n        return this.trav >= this.items.length ? [2, {\n          value: null,\n          done: !0\n        }] : (t = this.items[this.trav], e = t instanceof Tensor ? clone(t) : t, this.trav++, [2, {\n          value: e,\n          done: !1\n        }]);\n      });\n    });\n  }, e;\n}(LazyIterator),\n    FunctionCallIterator = function (t) {\n  function e(e) {\n    var r = t.call(this) || this;\n    return r.nextFn = e, r;\n  }\n\n  return __extends(e, t), e.prototype.summary = function () {\n    return \"Function call\";\n  }, e.prototype.next = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (t) {\n        try {\n          return [2, this.nextFn()];\n        } catch (t) {\n          throw t.message = \"Error thrown while iterating through a dataset: \" + t.message, t;\n        }\n\n        return [2];\n      });\n    });\n  }, e;\n}(LazyIterator),\n    SerialIterator = function (t) {\n  function e(e) {\n    var r = t.call(this) || this;\n    return r.upstream = e, r.lastRead = Promise.resolve({\n      value: null,\n      done: !1\n    }), r;\n  }\n\n  return __extends(e, t), e.prototype.summary = function () {\n    return this.upstream.summary() + \" -> Serial\";\n  }, e.prototype.next = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var t = this;\n      return __generator(this, function (e) {\n        return this.lastRead = this.lastRead.then(function () {\n          return t.serialNext();\n        }), [2, this.lastRead];\n      });\n    });\n  }, e.prototype.serialNext = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (t) {\n        return [2, this.upstream.next()];\n      });\n    });\n  }, e;\n}(LazyIterator),\n    SkipIterator = function (t) {\n  function e(e, r) {\n    var n = t.call(this) || this;\n    return n.upstream = e, n.maxCount = r, n.count = 0, n.lastRead = Promise.resolve({\n      value: null,\n      done: !1\n    }), n;\n  }\n\n  return __extends(e, t), e.prototype.summary = function () {\n    return this.upstream.summary() + \" -> Skip\";\n  }, e.prototype.next = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var t = this;\n      return __generator(this, function (e) {\n        return this.lastRead = this.lastRead.then(function () {\n          return t.serialNext();\n        }), [2, this.lastRead];\n      });\n    });\n  }, e.prototype.serialNext = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var t;\n      return __generator(this, function (e) {\n        switch (e.label) {\n          case 0:\n            return this.count++ < this.maxCount ? [4, this.upstream.next()] : [3, 2];\n\n          case 1:\n            return (t = e.sent()).done ? [2, t] : (dispose(t.value), [3, 0]);\n\n          case 2:\n            return [2, this.upstream.next()];\n        }\n      });\n    });\n  }, e;\n}(LazyIterator),\n    TakeIterator = function (t) {\n  function e(e, r) {\n    var n = t.call(this) || this;\n    return n.upstream = e, n.maxCount = r, n.count = 0, n;\n  }\n\n  return __extends(e, t), e.prototype.summary = function () {\n    return this.upstream.summary() + \" -> Take\";\n  }, e.prototype.next = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (t) {\n        return this.count++ >= this.maxCount ? [2, {\n          value: null,\n          done: !0\n        }] : [2, this.upstream.next()];\n      });\n    });\n  }, e;\n}(LazyIterator),\n    RowMajorBatchIterator = function (t) {\n  function e(e, r, n) {\n    void 0 === n && (n = !0);\n    var o = t.call(this) || this;\n    return o.upstream = e, o.batchSize = r, o.enableSmallLastBatch = n, o.lastRead = Promise.resolve({\n      value: null,\n      done: !1\n    }), o;\n  }\n\n  return __extends(e, t), e.prototype.summary = function () {\n    return this.upstream.summary() + \" -> RowMajorBatch\";\n  }, e.prototype.next = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var t = this;\n      return __generator(this, function (e) {\n        return this.lastRead = this.lastRead.then(function () {\n          return t.serialNext();\n        }), [2, this.lastRead];\n      });\n    });\n  }, e.prototype.serialNext = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var t, e;\n      return __generator(this, function (r) {\n        switch (r.label) {\n          case 0:\n            t = [], r.label = 1;\n\n          case 1:\n            return t.length < this.batchSize ? [4, this.upstream.next()] : [3, 3];\n\n          case 2:\n            return (e = r.sent()).done ? this.enableSmallLastBatch && t.length > 0 ? [2, {\n              value: t,\n              done: !1\n            }] : [2, {\n              value: null,\n              done: !0\n            }] : (t.push(e.value), [3, 1]);\n\n          case 3:\n            return [2, {\n              value: t,\n              done: !1\n            }];\n        }\n      });\n    });\n  }, e;\n}(LazyIterator),\n    FilterIterator = function (t) {\n  function e(e, r) {\n    var n = t.call(this) || this;\n    return n.upstream = e, n.predicate = r, n.lastRead = Promise.resolve({\n      value: null,\n      done: !1\n    }), n;\n  }\n\n  return __extends(e, t), e.prototype.summary = function () {\n    return this.upstream.summary() + \" -> Filter\";\n  }, e.prototype.next = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var t = this;\n      return __generator(this, function (e) {\n        return this.lastRead = this.lastRead.then(function () {\n          return t.serialNext();\n        }), [2, this.lastRead];\n      });\n    });\n  }, e.prototype.serialNext = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var t;\n      return __generator(this, function (e) {\n        switch (e.label) {\n          case 0:\n            return [4, this.upstream.next()];\n\n          case 1:\n            return (t = e.sent()).done || this.predicate(t.value) ? [2, t] : (dispose(t.value), [3, 0]);\n\n          case 2:\n            return [2];\n        }\n      });\n    });\n  }, e;\n}(LazyIterator),\n    MapIterator = function (t) {\n  function e(e, r) {\n    var n = t.call(this) || this;\n    return n.upstream = e, n.transform = r, n;\n  }\n\n  return __extends(e, t), e.prototype.summary = function () {\n    return this.upstream.summary() + \" -> Map\";\n  }, e.prototype.next = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var t, e, r, n, o, i, s;\n      return __generator(this, function (a) {\n        switch (a.label) {\n          case 0:\n            return [4, this.upstream.next()];\n\n          case 1:\n            if ((t = a.sent()).done) return [2, {\n              value: null,\n              done: !0\n            }];\n\n            for (e = tensor_util_6(t.value), r = this.transform(t.value), n = tensor_util_6(r), o = 0, i = e; o < i.length; o++) {\n              s = i[o], tensor_util_3(s, n) || s.dispose();\n            }\n\n            return [2, {\n              value: r,\n              done: !1\n            }];\n        }\n      });\n    });\n  }, e;\n}(LazyIterator),\n    ErrorHandlingLazyIterator = function (t) {\n  function e(e, r) {\n    var n = t.call(this) || this;\n    return n.upstream = e, n.handler = r, n.count = 0, n.lastRead = Promise.resolve({\n      value: null,\n      done: !1\n    }), n;\n  }\n\n  return __extends(e, t), e.prototype.summary = function () {\n    return this.upstream.summary() + \" -> handleErrors\";\n  }, e.prototype.next = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var t = this;\n      return __generator(this, function (e) {\n        return this.lastRead = this.lastRead.then(function () {\n          return t.serialNext();\n        }), [2, this.lastRead];\n      });\n    });\n  }, e.prototype.serialNext = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var t;\n      return __generator(this, function (e) {\n        switch (e.label) {\n          case 0:\n            e.label = 1;\n\n          case 1:\n            return e.trys.push([1, 3,, 4]), [4, this.upstream.next()];\n\n          case 2:\n            return [2, e.sent()];\n\n          case 3:\n            return t = e.sent(), this.handler(t) ? [3, 4] : [2, {\n              value: null,\n              done: !0\n            }];\n\n          case 4:\n            return [3, 0];\n\n          case 5:\n            return [2];\n        }\n      });\n    });\n  }, e;\n}(LazyIterator),\n    AsyncMapIterator = function (t) {\n  function e(e, r) {\n    var n = t.call(this) || this;\n    return n.upstream = e, n.transform = r, n;\n  }\n\n  return __extends(e, t), e.prototype.summary = function () {\n    return this.upstream.summary() + \" -> AsyncMap\";\n  }, e.prototype.next = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var t, e, r, n, o, i, s;\n      return __generator(this, function (a) {\n        switch (a.label) {\n          case 0:\n            return [4, this.upstream.next()];\n\n          case 1:\n            return (t = a.sent()).done ? [2, {\n              value: null,\n              done: !0\n            }] : (e = tensor_util_6(t.value), [4, this.transform(t.value)]);\n\n          case 2:\n            for (r = a.sent(), n = tensor_util_6(r), o = 0, i = e; o < i.length; o++) {\n              s = i[o], tensor_util_3(s, n) || s.dispose();\n            }\n\n            return [2, {\n              value: r,\n              done: !1\n            }];\n        }\n      });\n    });\n  }, e;\n}(LazyIterator),\n    OneToManyIterator = function (t) {\n  function e() {\n    var e = t.call(this) || this;\n    return e.outputQueue = new GrowingRingBuffer(), e.lastRead = Promise.resolve({\n      value: null,\n      done: !1\n    }), e;\n  }\n\n  return __extends(e, t), e.prototype.next = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var t = this;\n      return __generator(this, function (e) {\n        return this.lastRead = this.lastRead.then(function () {\n          return t.serialNext();\n        }), [2, this.lastRead];\n      });\n    });\n  }, e.prototype.serialNext = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (t) {\n        switch (t.label) {\n          case 0:\n            return 0 !== this.outputQueue.length() ? [3, 2] : [4, this.pump()];\n\n          case 1:\n            return t.sent() ? [3, 0] : [2, {\n              value: null,\n              done: !0\n            }];\n\n          case 2:\n            return [2, {\n              value: this.outputQueue.shift(),\n              done: !1\n            }];\n        }\n      });\n    });\n  }, e;\n}(LazyIterator),\n    FlatmapIterator = function (t) {\n  function e(e, r) {\n    var n = t.call(this) || this;\n    return n.upstream = e, n.transform = r, n;\n  }\n\n  return __extends(e, t), e.prototype.summary = function () {\n    return this.upstream.summary() + \" -> Flatmap\";\n  }, e.prototype.pump = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var t, e, r, n, o, i, s;\n      return __generator(this, function (a) {\n        switch (a.label) {\n          case 0:\n            return [4, this.upstream.next()];\n\n          case 1:\n            if ((t = a.sent()).done) return [2, !1];\n\n            for (e = tensor_util_6(t.value), r = this.transform(t.value), n = tensor_util_6(r), this.outputQueue.pushAll(r), o = 0, i = e; o < i.length; o++) {\n              s = i[o], tensor_util_3(s, n) || s.dispose();\n            }\n\n            return [2, !0];\n        }\n      });\n    });\n  }, e;\n}(OneToManyIterator),\n    ChainedIterator = function (t) {\n  function e(e, r) {\n    var n = t.call(this) || this;\n    return n.baseErrorHandler = r, n.lastRead = null, n.iterator = null, n.moreIterators = e, n;\n  }\n\n  return __extends(e, t), e.prototype.summary = function () {\n    return \"TODO: fill in upstream of chained summaries -> Chained\";\n  }, e.prototype.next = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (t) {\n        return this.lastRead = this.readFromChain(this.lastRead), [2, this.lastRead];\n      });\n    });\n  }, e.prototype.readFromChain = function (t) {\n    return __awaiter(this, void 0, void 0, function () {\n      var e, r;\n      return __generator(this, function (n) {\n        switch (n.label) {\n          case 0:\n            return [4, t];\n\n          case 1:\n            return n.sent(), null != this.iterator ? [3, 3] : [4, this.moreIterators.next()];\n\n          case 2:\n            if ((e = n.sent()).done) return [2, {\n              value: null,\n              done: !0\n            }];\n            this.iterator = e.value, null != this.baseErrorHandler && (this.iterator = this.iterator.handleErrors(this.baseErrorHandler)), n.label = 3;\n\n          case 3:\n            return [4, this.iterator.next()];\n\n          case 4:\n            return (r = n.sent()).done ? (this.iterator = null, [2, this.readFromChain(t)]) : [2, r];\n        }\n      });\n    });\n  }, e;\n}(LazyIterator);\n\n!function (t) {\n  t[t.FAIL = 0] = \"FAIL\", t[t.SHORTEST = 1] = \"SHORTEST\", t[t.LONGEST = 2] = \"LONGEST\";\n}(ZipMismatchMode || (ZipMismatchMode = {}));\n\nvar ZipIterator = function (t) {\n  function e(e, r) {\n    void 0 === r && (r = ZipMismatchMode.FAIL);\n    var n = t.call(this) || this;\n    return n.iterators = e, n.mismatchMode = r, n.count = 0, n.currentPromise = null, n;\n  }\n\n  return __extends(e, t), e.prototype.summary = function () {\n    return \"{TODO: fill in upstream of zip summaries} -> Zip\";\n  }, e.prototype.nextState = function (t) {\n    return __awaiter(this, void 0, void 0, function () {\n      function e(t) {\n        return t instanceof LazyIterator ? {\n          value: t.next().then(function (t) {\n            return r++, t.done && n++, t.value;\n          }),\n          recurse: !1\n        } : {\n          value: null,\n          recurse: !0\n        };\n      }\n\n      var r, n, o;\n      return __generator(this, function (i) {\n        switch (i.label) {\n          case 0:\n            return [4, t];\n\n          case 1:\n            return i.sent(), r = 0, n = 0, [4, deepMapAndAwaitAll(this.iterators, e)];\n\n          case 2:\n            if (o = i.sent(), r === n) return [2, {\n              value: null,\n              done: !0\n            }];\n            if (n > 0) switch (this.mismatchMode) {\n              case ZipMismatchMode.FAIL:\n                throw new Error(\"Zipped streams should have the same length. Mismatched at element \" + this.count + \".\");\n\n              case ZipMismatchMode.SHORTEST:\n                return [2, {\n                  value: null,\n                  done: !0\n                }];\n\n              case ZipMismatchMode.LONGEST:\n            }\n            return this.count++, [2, {\n              value: o,\n              done: !1\n            }];\n        }\n      });\n    });\n  }, e.prototype.next = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (t) {\n        switch (t.label) {\n          case 0:\n            return this.currentPromise = this.nextState(this.currentPromise), [4, this.currentPromise];\n\n          case 1:\n            return [2, t.sent()];\n        }\n      });\n    });\n  }, e;\n}(LazyIterator),\n    PrefetchIterator = function (t) {\n  function e(e, r) {\n    var n = t.call(this) || this;\n    return n.upstream = e, n.bufferSize = r, n.buffer = new RingBuffer(r), n;\n  }\n\n  return __extends(e, t), e.prototype.summary = function () {\n    return this.upstream.summary() + \" -> Prefetch\";\n  }, e.prototype.refill = function () {\n    for (; !this.buffer.isFull();) {\n      var t = this.upstream.next();\n      this.buffer.push(t);\n    }\n  }, e.prototype.next = function () {\n    return this.refill(), this.buffer.shift();\n  }, e;\n}(LazyIterator),\n    ShuffleIterator = function (t) {\n  function e(e, r, n) {\n    var o = t.call(this, e, r) || this;\n    return o.upstream = e, o.windowSize = r, o.upstreamExhausted = !1, o.random = seedrandom_1(n || util.now().toString()), o.lastRead = Promise.resolve({\n      value: null,\n      done: !1\n    }), o;\n  }\n\n  return __extends(e, t), e.prototype.next = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var t = this;\n      return __generator(this, function (e) {\n        return this.lastRead = this.lastRead.then(function () {\n          return t.serialNext();\n        }), [2, this.lastRead];\n      });\n    });\n  }, e.prototype.randomInt = function (t) {\n    return Math.floor(this.random() * t);\n  }, e.prototype.chooseIndex = function () {\n    return this.randomInt(this.buffer.length());\n  }, e.prototype.serialNext = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var t, e;\n      return __generator(this, function (r) {\n        switch (r.label) {\n          case 0:\n            this.upstreamExhausted || this.refill(), r.label = 1;\n\n          case 1:\n            return this.buffer.isEmpty() ? [3, 3] : (t = this.chooseIndex(), [4, this.buffer.shuffleExcise(t)]);\n\n          case 2:\n            return (e = r.sent()).done ? (this.upstreamExhausted = !0, [3, 1]) : (this.refill(), [2, e]);\n\n          case 3:\n            return [2, {\n              value: null,\n              done: !0\n            }];\n        }\n      });\n    });\n  }, e;\n}(PrefetchIterator),\n    Dataset = function () {\n  function t() {\n    this.size = null;\n  }\n\n  return t.prototype.batch = function (t, e) {\n    var r = this;\n    void 0 === e && (e = !0);\n    var n = this;\n    return util.assert(t > 0, \"batchSize need to be positive, but it is\\n      \" + t), datasetFromIteratorFn(function () {\n      return __awaiter(r, void 0, void 0, function () {\n        return __generator(this, function (r) {\n          switch (r.label) {\n            case 0:\n              return [4, n.iterator()];\n\n            case 1:\n              return [2, r.sent().columnMajorBatch(t, e, deepBatchConcat)];\n          }\n        });\n      });\n    }, this.size === 1 / 0 || null == this.size ? this.size : e ? Math.ceil(this.size / t) : Math.floor(this.size / t));\n  }, t.prototype.concatenate = function (t) {\n    var e = this,\n        r = this;\n    return datasetFromIteratorFn(function () {\n      return __awaiter(e, void 0, void 0, function () {\n        var e, n;\n        return __generator(this, function (o) {\n          switch (o.label) {\n            case 0:\n              return [4, r.iterator()];\n\n            case 1:\n              return n = (e = o.sent()).concatenate, [4, t.iterator()];\n\n            case 2:\n              return [2, n.apply(e, [o.sent()])];\n          }\n        });\n      });\n    }, this.size === 1 / 0 || t.size === 1 / 0 ? 1 / 0 : null != this.size && null != t.size ? this.size + t.size : null);\n  }, t.prototype.filter = function (t) {\n    var e = this,\n        r = this;\n    return datasetFromIteratorFn(function () {\n      return __awaiter(e, void 0, void 0, function () {\n        return __generator(this, function (e) {\n          switch (e.label) {\n            case 0:\n              return [4, r.iterator()];\n\n            case 1:\n              return [2, e.sent().filter(function (e) {\n                return tidy(function () {\n                  return t(e);\n                });\n              })];\n          }\n        });\n      });\n    }, this.size === 1 / 0 ? 1 / 0 : null);\n  }, t.prototype.forEachAsync = function (t) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (e) {\n        switch (e.label) {\n          case 0:\n            return [4, this.iterator()];\n\n          case 1:\n            return [2, e.sent().forEachAsync(t)];\n        }\n      });\n    });\n  }, t.prototype.forEach = function (t) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (e) {\n        return deprecationWarn(\"dataset.forEach() is deprecated and will be removed. Please use dataset.forEachAsync() instead\"), [2, this.forEachAsync(t)];\n      });\n    });\n  }, t.prototype.map = function (t) {\n    var e = this,\n        r = this;\n    return datasetFromIteratorFn(function () {\n      return __awaiter(e, void 0, void 0, function () {\n        return __generator(this, function (e) {\n          switch (e.label) {\n            case 0:\n              return [4, r.iterator()];\n\n            case 1:\n              return [2, e.sent().map(function (e) {\n                return tidy(function () {\n                  return t(e);\n                });\n              })];\n          }\n        });\n      });\n    }, this.size);\n  }, t.prototype.mapAsync = function (t) {\n    var e = this,\n        r = this;\n    return datasetFromIteratorFn(function () {\n      return __awaiter(e, void 0, void 0, function () {\n        return __generator(this, function (e) {\n          switch (e.label) {\n            case 0:\n              return [4, r.iterator()];\n\n            case 1:\n              return [2, e.sent().mapAsync(t)];\n          }\n        });\n      });\n    }, this.size);\n  }, t.prototype.prefetch = function (t) {\n    var e = this,\n        r = this;\n    return datasetFromIteratorFn(function () {\n      return __awaiter(e, void 0, void 0, function () {\n        return __generator(this, function (e) {\n          switch (e.label) {\n            case 0:\n              return [4, r.iterator()];\n\n            case 1:\n              return [2, e.sent().prefetch(t)];\n          }\n        });\n      });\n    }, this.size);\n  }, t.prototype.repeat = function (t) {\n    var e = this,\n        r = this;\n    return datasetFromIteratorFn(function () {\n      return __awaiter(e, void 0, void 0, function () {\n        var e = this;\n        return __generator(this, function (n) {\n          return [2, iteratorFromConcatenated(iteratorFromFunction(function () {\n            return __awaiter(e, void 0, void 0, function () {\n              var t;\n              return __generator(this, function (e) {\n                switch (e.label) {\n                  case 0:\n                    return t = {}, [4, r.iterator()];\n\n                  case 1:\n                    return [2, (t.value = e.sent(), t.done = !1, t)];\n                }\n              });\n            });\n          }).take(t))];\n        });\n      });\n    }, null != this.size && t > 0 ? this.size * t : 0 === t ? 0 : null != this.size && (void 0 === t || t < 0) ? 1 / 0 : null);\n  }, t.prototype.skip = function (t) {\n    var e = this,\n        r = this;\n    return datasetFromIteratorFn(function () {\n      return __awaiter(e, void 0, void 0, function () {\n        return __generator(this, function (e) {\n          switch (e.label) {\n            case 0:\n              return [4, r.iterator()];\n\n            case 1:\n              return [2, e.sent().skip(t)];\n          }\n        });\n      });\n    }, null != this.size && t >= 0 && this.size >= t ? this.size - t : null != this.size && (this.size < t || void 0 === t || t < 0) ? 0 : null);\n  }, t.prototype.shuffle = function (t, e, r) {\n    var n = this;\n    void 0 === r && (r = !0);\n    var o = this,\n        i = seedrandom_1(e || util.now().toString());\n    return datasetFromIteratorFn(function () {\n      return __awaiter(n, void 0, void 0, function () {\n        var e;\n        return __generator(this, function (n) {\n          switch (n.label) {\n            case 0:\n              return e = i.int32(), r && (e += i.int32()), [4, o.iterator()];\n\n            case 1:\n              return [2, n.sent().shuffle(t, e.toString())];\n          }\n        });\n      });\n    }, this.size);\n  }, t.prototype.take = function (t) {\n    var e = this,\n        r = this;\n    return datasetFromIteratorFn(function () {\n      return __awaiter(e, void 0, void 0, function () {\n        return __generator(this, function (e) {\n          switch (e.label) {\n            case 0:\n              return [4, r.iterator()];\n\n            case 1:\n              return [2, e.sent().take(t)];\n          }\n        });\n      });\n    }, null != this.size && this.size > t ? t : null != this.size && this.size <= t ? this.size : null);\n  }, t.prototype.toArray = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (t) {\n        switch (t.label) {\n          case 0:\n            return [4, this.iterator()];\n\n          case 1:\n            return [2, t.sent().collect()];\n        }\n      });\n    });\n  }, t;\n}();\n\nfunction datasetFromIteratorFn(t, e) {\n  return void 0 === e && (e = null), new (function (r) {\n    function n() {\n      var t = null !== r && r.apply(this, arguments) || this;\n      return t.size = e, t;\n    }\n\n    return __extends(n, r), n.prototype.iterator = function () {\n      return __awaiter(this, void 0, void 0, function () {\n        return __generator(this, function (e) {\n          return [2, t()];\n        });\n      });\n    }, n;\n  }(Dataset))();\n}\n\nfunction array(t) {\n  var e = this;\n  return datasetFromIteratorFn(function () {\n    return __awaiter(e, void 0, void 0, function () {\n      return __generator(this, function (e) {\n        return [2, iteratorFromItems(t)];\n      });\n    });\n  }, t.length);\n}\n\nfunction zip(t) {\n  var e,\n      r = this;\n  if (!isIterable(t)) throw new Error(\"The argument to zip() must be an object or array.\");\n  if (Array.isArray(t)) for (var n = 0; n < t.length; n++) {\n    e = null == e ? t[n].size : Math.min(e, t[n].size);\n  } else if (t instanceof Object) for (var o in t) {\n    e = null == e ? t[o].size : Math.min(e, t[o].size);\n  }\n  return datasetFromIteratorFn(function () {\n    return __awaiter(r, void 0, void 0, function () {\n      return __generator(this, function (e) {\n        switch (e.label) {\n          case 0:\n            return [4, deepMapAndAwaitAll(t, function (t) {\n              if (t instanceof Dataset) return {\n                value: t.iterator(),\n                recurse: !1\n              };\n              if (isIterable(t)) return {\n                value: null,\n                recurse: !0\n              };\n              throw new Error(\"Leaves of the structure passed to zip() must be Datasets, not primitives.\");\n            })];\n\n          case 1:\n            return [2, iteratorFromZipped(e.sent(), ZipMismatchMode.SHORTEST)];\n        }\n      });\n    });\n  }, e);\n}\n\nfunction deepBatchConcat(t) {\n  if (null === t) return null;\n  var e = t[0];\n  return \"string\" == typeof e ? {\n    value: t,\n    recurse: !1\n  } : isIterable(e) ? isNumericArray(e) ? {\n    value: batchConcat(t),\n    recurse: !1\n  } : {\n    value: null,\n    recurse: !0\n  } : {\n    value: batchConcat(t),\n    recurse: !1\n  };\n}\n\nfunction batchConcat(t) {\n  if (0 === t.length) throw new Error(\"Can't make a batch of zero elements.\");\n  if (t[0] instanceof Tensor) return stack(t);\n  if (Array.isArray(t[0])) return batchConcatArrays(t);\n  var e = t;\n  return Tensor.make([e.length], {\n    values: new Float32Array(e)\n  });\n}\n\nfunction batchConcatArrays(t) {\n  for (var e = t[0].length, r = [t.length, t[0].length], n = new Float32Array(t.length * e), o = 0, i = 0, s = t; i < s.length; i++) {\n    var a = s[i];\n    if (a.length !== e) throw new Error(\"Elements must have the same shape to be batched\");\n    n.set(a, o), o += e;\n  }\n\n  return Tensor.make(r, {\n    values: n\n  });\n}\n\nvar TextLineDataset = function (t) {\n  function e(e) {\n    var r = t.call(this) || this;\n    return r.input = e, r;\n  }\n\n  return __extends(e, t), e.prototype.iterator = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var t, e;\n      return __generator(this, function (r) {\n        switch (r.label) {\n          case 0:\n            return [4, this.input.iterator()];\n\n          case 1:\n            return t = r.sent(), e = t.decodeUTF8(), [2, e.split(\"\\n\")];\n        }\n      });\n    });\n  }, e;\n}(Dataset),\n    CODE_QUOTE = '\"',\n    STATE_OUT = Symbol(\"out\"),\n    STATE_FIELD = Symbol(\"field\"),\n    STATE_QUOTE = Symbol(\"quote\"),\n    STATE_QUOTE_AFTER_QUOTE = Symbol(\"quoteafterquote\"),\n    STATE_WITHIN_QUOTE_IN_QUOTE = Symbol(\"quoteinquote\"),\n    CSVDataset = function (t) {\n  function e(e, r) {\n    var n = t.call(this) || this;\n    return n.input = e, n.hasHeader = !0, n.fullColumnNames = null, n.columnNamesValidated = !1, n.columnConfigs = null, n.configuredColumnsOnly = !1, n.delimiter = \",\", n.base = new TextLineDataset(e), r || (r = {}), n.hasHeader = !1 !== r.hasHeader, n.fullColumnNames = r.columnNames, n.columnConfigs = r.columnConfigs, n.configuredColumnsOnly = r.configuredColumnsOnly, n.delimiter = r.delimiter ? r.delimiter : \",\", n;\n  }\n\n  return __extends(e, t), e.prototype.columnNames = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (t) {\n        switch (t.label) {\n          case 0:\n            return this.columnNamesValidated ? [3, 2] : [4, this.setColumnNames()];\n\n          case 1:\n            t.sent(), t.label = 2;\n\n          case 2:\n            return [2, this.configuredColumnsOnly ? Object.keys(this.columnConfigs) : this.fullColumnNames];\n        }\n      });\n    });\n  }, e.prototype.setColumnNames = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var t, e, r, n, o, i;\n      return __generator(this, function (s) {\n        switch (s.label) {\n          case 0:\n            return [4, this.maybeReadHeaderLine()];\n\n          case 1:\n            if (t = s.sent(), !this.fullColumnNames && !t) throw new Error(\"Column names must be provided if there is no header line.\");\n            if (this.fullColumnNames && t && util.assert(t.length === this.fullColumnNames.length, \"The length of provided columnNames (\" + this.fullColumnNames.length.toString() + \") does not match the length of the header line read from file (\" + t.length.toString() + \").\"), this.fullColumnNames || (this.fullColumnNames = t), e = this.fullColumnNames.reduce(function (t, e) {\n              return t[e] = t[e] + 1 || 1, t;\n            }, {}), r = Object.keys(e).filter(function (t) {\n              return e[t] > 1;\n            }), util.assert(0 === r.length, \"Duplicate column names found: \" + r.toString()), this.columnConfigs) for (n = 0, o = Object.keys(this.columnConfigs); n < o.length; n++) {\n              if (i = o[n], -1 === this.fullColumnNames.indexOf(i)) throw new Error('The key \"' + i + '\" provided in columnConfigs does not match any of the column names (' + this.fullColumnNames.toString() + \").\");\n            }\n            return this.columnNamesValidated = !0, [2];\n        }\n      });\n    });\n  }, e.prototype.maybeReadHeaderLine = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var t;\n      return __generator(this, function (e) {\n        switch (e.label) {\n          case 0:\n            return this.hasHeader ? [4, this.base.iterator()] : [3, 3];\n\n          case 1:\n            return [4, e.sent().next()];\n\n          case 2:\n            if ((t = e.sent()).done) throw new Error(\"No data was found for CSV parsing.\");\n            return [2, t.value.split(this.delimiter)];\n\n          case 3:\n            return [2, null];\n        }\n      });\n    });\n  }, e.prototype.iterator = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var t,\n          e = this;\n      return __generator(this, function (r) {\n        switch (r.label) {\n          case 0:\n            return this.columnNamesValidated ? [3, 2] : [4, this.setColumnNames()];\n\n          case 1:\n            r.sent(), r.label = 2;\n\n          case 2:\n            return [4, this.base.iterator()];\n\n          case 3:\n            return t = r.sent(), this.hasHeader && (t = t.skip(1)), [2, t.map(function (t) {\n              return e.makeDataElement(t);\n            })];\n        }\n      });\n    });\n  }, e.prototype.makeDataElement = function (t) {\n    for (var e = this.parseRow(t), r = {}, n = {}, o = 0; o < this.fullColumnNames.length; o++) {\n      var i = this.fullColumnNames[o],\n          s = this.columnConfigs ? this.columnConfigs[i] : null;\n\n      if (!this.configuredColumnsOnly || s) {\n        var a = e[o],\n            u = null;\n        if (\"\" === a) {\n          if (s && void 0 !== s.default) u = s.default;else {\n            if (s && (s.required || s.isLabel)) throw new Error(\"Required column \" + i + \" is empty in this line: \" + t);\n            u = void 0;\n          }\n        } else {\n          var h = Number(a);\n          if (isNaN(h)) u = s && \"bool\" === s.dtype ? this.getBoolean(a) : a;else if (s && s.dtype) switch (s.dtype) {\n            case \"float32\":\n              u = h;\n              break;\n\n            case \"int32\":\n              u = Math.floor(h);\n              break;\n\n            case \"bool\":\n              u = this.getBoolean(a);\n              break;\n\n            default:\n              u = h;\n          } else u = h;\n        }\n        s && s.isLabel ? n[i] = u : r[i] = u;\n      }\n    }\n\n    return 0 === Object.keys(n).length ? r : [r, n];\n  }, e.prototype.getBoolean = function (t) {\n    return \"1\" === t || \"true\" === t.toLowerCase() ? 1 : 0;\n  }, e.prototype.parseRow = function (t) {\n    for (var e = [], r = 0, n = t.length, o = STATE_FIELD, i = 0; i < n; i++) {\n      switch (o) {\n        case STATE_OUT:\n          switch (t.charAt(i)) {\n            case CODE_QUOTE:\n              r = i + 1, o = STATE_QUOTE;\n              break;\n\n            case this.delimiter:\n              e.push(\"\"), o = STATE_OUT, r = i + 1;\n              break;\n\n            default:\n              o = STATE_FIELD, r = i;\n          }\n\n          break;\n\n        case STATE_FIELD:\n          switch (t.charAt(i)) {\n            case this.delimiter:\n              e.push(t.substring(r, i)), o = STATE_OUT, r = i + 1;\n          }\n\n          break;\n\n        case STATE_QUOTE:\n          switch (t.charAt(i)) {\n            case CODE_QUOTE:\n              o = STATE_QUOTE_AFTER_QUOTE;\n          }\n\n          break;\n\n        case STATE_QUOTE_AFTER_QUOTE:\n          switch (t.charAt(i)) {\n            case this.delimiter:\n              e.push(t.substring(r, i - 1)), o = STATE_OUT, r = i + 1;\n              break;\n\n            case CODE_QUOTE:\n              o = STATE_QUOTE;\n              break;\n\n            default:\n              o = STATE_WITHIN_QUOTE_IN_QUOTE;\n          }\n\n          break;\n\n        case STATE_WITHIN_QUOTE_IN_QUOTE:\n          switch (t.charAt(i)) {\n            case CODE_QUOTE:\n              o = STATE_QUOTE;\n          }\n\n      }\n    }\n\n    return o === STATE_QUOTE_AFTER_QUOTE ? e.push(t.substring(r, n - 1)) : e.push(t.substring(r)), e;\n  }, e;\n}(Dataset),\n    DataSource = function () {\n  return function () {};\n}(),\n    StringIterator = function (t) {\n  function e() {\n    return null !== t && t.apply(this, arguments) || this;\n  }\n\n  return __extends(e, t), e.prototype.split = function (t) {\n    return new SplitIterator(this, t);\n  }, e;\n}(LazyIterator),\n    SplitIterator = function (t) {\n  function e(e, r) {\n    var n = t.call(this) || this;\n    return n.upstream = e, n.impl = new SplitIteratorImpl(e, r), n;\n  }\n\n  return __extends(e, t), e.prototype.summary = function () {\n    return this.impl.summary();\n  }, e.prototype.next = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (t) {\n        return [2, this.impl.next()];\n      });\n    });\n  }, e;\n}(StringIterator),\n    SplitIteratorImpl = function (t) {\n  function e(e, r) {\n    var n = t.call(this) || this;\n    return n.upstream = e, n.separator = r, n.carryover = \"\", n;\n  }\n\n  return __extends(e, t), e.prototype.summary = function () {\n    return this.upstream.summary() + \" -> Split('\" + this.separator + \"')\";\n  }, e.prototype.pump = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var t, e, r, n, o;\n      return __generator(this, function (i) {\n        switch (i.label) {\n          case 0:\n            return [4, this.upstream.next()];\n\n          case 1:\n            if ((t = i.sent()).done) return \"\" === this.carryover ? [2, !1] : (this.outputQueue.push(this.carryover), this.carryover = \"\", [2, !0]);\n\n            for ((e = t.value.split(this.separator))[0] = this.carryover + e[0], r = 0, n = e.slice(0, -1); r < n.length; r++) {\n              o = n[r], this.outputQueue.push(o);\n            }\n\n            return this.carryover = e[e.length - 1], [2, !0];\n        }\n      });\n    });\n  }, e;\n}(OneToManyIterator),\n    ByteChunkIterator = function (t) {\n  function e() {\n    return null !== t && t.apply(this, arguments) || this;\n  }\n\n  return __extends(e, t), e.prototype.decodeUTF8 = function () {\n    return new Utf8Iterator(this);\n  }, e;\n}(LazyIterator),\n    Utf8Iterator = function (t) {\n  function e(e) {\n    var r = t.call(this) || this;\n    return r.upstream = e, r.impl = new Utf8IteratorImpl(e), r;\n  }\n\n  return __extends(e, t), e.prototype.summary = function () {\n    return this.impl.summary();\n  }, e.prototype.next = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (t) {\n        return [2, this.impl.next()];\n      });\n    });\n  }, e;\n}(StringIterator),\n    Utf8IteratorImpl = function (t) {\n  function e(e) {\n    var r = t.call(this) || this;\n    if (r.upstream = e, ENV.get(\"IS_BROWSER\")) r.decoder = new TextDecoder(\"utf-8\");else {\n      var n = require(\"string_decoder\").StringDecoder;\n\n      r.decoder = new n(\"utf8\");\n    }\n    return r;\n  }\n\n  return __extends(e, t), e.prototype.summary = function () {\n    return this.upstream.summary() + \" -> Utf8\";\n  }, e.prototype.pump = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var t, e, r;\n      return __generator(this, function (n) {\n        switch (n.label) {\n          case 0:\n            return [4, this.upstream.next()];\n\n          case 1:\n            return (t = n.sent()).done ? [2, !1] : (e = t.value, r = ENV.get(\"IS_BROWSER\") ? this.decoder.decode(e, {\n              stream: !0\n            }) : this.decoder.write(Buffer.from(e.buffer)), this.outputQueue.push(r), [2, !0]);\n        }\n      });\n    });\n  }, e;\n}(OneToManyIterator),\n    FileChunkIterator = function (t) {\n  function e(e, r) {\n    void 0 === r && (r = {});\n    var n = t.call(this) || this;\n    return n.file = e, n.options = r, util.assert(e instanceof Uint8Array || !!ENV.get(\"IS_BROWSER\") && (e instanceof File || e instanceof Blob), \"FileChunkIterator only supports File, Blob and Uint8Array right now.\"), n.offset = r.offset || 0, n.chunkSize = r.chunkSize || 1048576, n;\n  }\n\n  return __extends(e, t), e.prototype.summary = function () {\n    return \"FileChunks \" + this.file;\n  }, e.prototype.next = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var t,\n          e,\n          r = this;\n      return __generator(this, function (n) {\n        switch (n.label) {\n          case 0:\n            return this.offset >= (this.file instanceof Uint8Array ? this.file.byteLength : this.file.size) ? [2, {\n              value: null,\n              done: !0\n            }] : (t = new Promise(function (t, e) {\n              var n = r.offset + r.chunkSize;\n              if (r.file instanceof Uint8Array) t(new Uint8Array(r.file.slice(r.offset, n)));else {\n                var o = new FileReader();\n                o.onload = function (r) {\n                  var n = o.result;\n                  if (n instanceof ArrayBuffer && (n = new Uint8Array(n)), !(n instanceof Uint8Array)) return e(new TypeError(\"FileReader returned unknown type.\"));\n                  t(n);\n                }, o.onabort = function (t) {\n                  return e(new Error(\"Aborted\"));\n                }, o.onerror = function (t) {\n                  return e(new Error(t.type));\n                };\n                var i = r.file.slice(r.offset, n);\n                o.readAsArrayBuffer(i);\n              }\n              r.offset = n;\n            }), e = {}, [4, t]);\n\n          case 1:\n            return [2, (e.value = n.sent(), e.done = !1, e)];\n        }\n      });\n    });\n  }, e;\n}(ByteChunkIterator);\n\nfunction urlChunkIterator(t, e) {\n  return void 0 === e && (e = {}), __awaiter(this, void 0, void 0, function () {\n    var r, n, o, i;\n    return __generator(this, function (s) {\n      switch (s.label) {\n        case 0:\n          return ENV.get(\"IS_BROWSER\") ? [4, fetch(t)] : [3, 5];\n\n        case 1:\n          return (r = s.sent()).ok ? [4, r.blob()] : [3, 3];\n\n        case 2:\n          return n = s.sent(), [2, new FileChunkIterator(n, e)];\n\n        case 3:\n          throw new Error(r.statusText);\n\n        case 4:\n          return [3, 9];\n\n        case 5:\n          if (o = require(\"node-fetch\"), \"string\" != typeof t) throw new Error(\"URL must be a string. Request objects are not supported in the node.js environment yet.\");\n          return [4, o(t)];\n\n        case 6:\n          return (r = s.sent()).ok ? [4, r.buffer()] : [3, 8];\n\n        case 7:\n          return i = s.sent(), [2, new FileChunkIterator(i, e)];\n\n        case 8:\n          throw new Error(r.statusText);\n\n        case 9:\n          return [2];\n      }\n    });\n  });\n}\n\nfunction isLocalPath(t) {\n  return \"string\" == typeof t && \"file://\" === t.substr(0, 7);\n}\n\nvar FileDataSource = function (t) {\n  function e(e, r) {\n    void 0 === r && (r = {});\n    var n = t.call(this) || this;\n    return n.input = e, n.options = r, n;\n  }\n\n  return __extends(e, t), e.prototype.iterator = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var t;\n      return __generator(this, function (e) {\n        return isLocalPath(this.input) && ENV.get(\"IS_NODE\") && (t = require(\"fs\"), this.input = t.readFileSync(this.input.substr(7))), [2, new FileChunkIterator(this.input, this.options)];\n      });\n    });\n  }, e;\n}(DataSource),\n    URLDataSource = function (t) {\n  function e(e, r) {\n    void 0 === r && (r = {});\n    var n = t.call(this) || this;\n    return n.url = e, n.fileOptions = r, n;\n  }\n\n  return __extends(e, t), e.prototype.iterator = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (t) {\n        return isLocalPath(this.url) ? [2, new FileDataSource(this.url, this.fileOptions).iterator()] : [2, urlChunkIterator(this.url, this.fileOptions)];\n      });\n    });\n  }, e;\n}(DataSource);\n\nfunction csv(t, e) {\n  return void 0 === e && (e = {}), new CSVDataset(new URLDataSource(t), e);\n}\n\nfunction generator(t) {\n  var e = this,\n      r = iteratorFromFunction(t);\n  return datasetFromIteratorFn(function () {\n    return __awaiter(e, void 0, void 0, function () {\n      return __generator(this, function (t) {\n        return [2, r];\n      });\n    });\n  });\n}\n\nvar version = \"0.2.3\";\nexport { array, Dataset, zip, CSVDataset, TextLineDataset, csv, generator, FileDataSource, URLDataSource, version as version_data };","map":null,"metadata":{},"sourceType":"module"}